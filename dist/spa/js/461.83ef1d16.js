"use strict";(globalThis["webpackChunksmi_frontend"]=globalThis["webpackChunksmi_frontend"]||[]).push([[461],{2461:(e,t,l)=>{l.r(t),l.d(t,{default:()=>qe});var a=l(3673),o=l(2323),s=l(1959),n=l(2993),i=l(925),r=l(9236),u=l(2505),d=l.n(u),c=function(e,t,l,a){function o(e){return e instanceof l?e:new l((function(t){t(e)}))}return new(l||(l=Promise))((function(l,s){function n(e){try{r(a.next(e))}catch(t){s(t)}}function i(e){try{r(a["throw"](e))}catch(t){s(t)}}function r(e){e.done?l(e.value):o(e.value).then(n,i)}r((a=a.apply(e,t||[])).next())}))};const v={class:"container"},m={class:"treasury-title"},p=(0,a._)("span",{class:"text-warning"},"Iglesia local",-1),_={class:"subtitle"},w={class:"row q-col-gutter-sm"},h={class:"col-xs-12 col-sm-4"},g={class:"col-xs-12 col-sm-4"},x={class:"col-xs-12 col-sm-4"},b={key:0,class:"row flow-items q-col-gutter-x-lg q-pt-md"},f={class:"flow-title col-12"},y={class:"row q-pb-xs"},U={class:"col-8"},k={class:"col-xs-4 col-sm-4"},N={class:"self-center full-width no-outline",tabindex:"0"},S={key:1,class:"row flow-navitagor"},z={key:0},T={key:2,class:"row tithe-column"},I={class:"col-12 q-mb-lg"},q={id:"report-flow",class:"row tithe-column col-12"},E={class:"flow-title col-12 q-mb-lg"},F={id:"pdf-church-name",style:{display:"none"}},A={class:"q-table-simple q-table__container q-table--horizontal-separator column no-wrap q-table--dense q-table--no-wrap col-12"},$={class:"q-table treasury-table-data"},L=(0,a._)("th",{class:"text-left"},[(0,a._)("strong",null,"Departamento")],-1),W={class:"text-right text-secondary"},D={class:"text-right text-positive"},G={class:"text-right text-negative"},C={class:"text-right"},H=(0,a._)("th",{class:"text-right text-primary"},[(0,a._)("strong",null,"Total Caja local")],-1),V={class:"text-left"},j={class:"flow-head-table"},R={class:"text-right text-secondary"},M={class:"flow-row-table"},O={class:"text-hidden"},P={class:"text-right text-positive"},Y={class:"flow-row-table"},Z={class:"text-hidden"},Q={class:"text-right text-negative"},B={class:"flow-row-table"},K={class:"text-hidden"},J={class:"text-right"},X={class:"flow-row-table"},ee={class:"text-hidden"},te={class:"text-right text-primary"},le={class:"flow-row-table"},ae=(0,a._)("span",{class:"text-hidden"},"Total:",-1),oe=(0,a._)("td",{class:"text-left"},[(0,a._)("span",{class:"flow-head-table"},[(0,a._)("strong",null,"TOTAL")])],-1),se={class:"text-right text-secondary"},ne={class:"flow-row-table"},ie={class:"text-hidden"},re={class:"text-right text-positive"},ue={class:"flow-row-table"},de={class:"text-hidden"},ce={class:"text-right text-negative"},ve={class:"flow-row-table"},me={class:"text-hidden"},pe={class:"text-right"},_e={class:"flow-row-table"},we=(0,a._)("span",{class:"text-hidden"},"Sub total:",-1),he={class:"text-right text-primary"},ge={class:"flow-row-table"},xe={class:"text-hidden"},be={key:3,class:"q-pa-sm text-primary"},fe=(0,a.aZ)({__name:"General",setup(e){var t,l;const u=(0,r.o)(),fe=null===(l=null===(t=u.state.user)||void 0===t?void 0:t.user)||void 0===l?void 0:l.company.id,ye=()=>c(this,void 0,void 0,(function*(){const e=`entries?id_company=${fe}&state=ACTIVE`,t=yield n.http.get(e);t.count>0&&(Ne.value=1===t.rows[0].month?12:t.rows[0].month-1,Ue.value=1===t.rows[0].month?t.rows[0].year-1:t.rows[0].year)})),Ue=(0,s.iH)(0),ke=(0,s.iH)("MONTH"),Ne=(0,s.iH)(0),Se=i.e7.map(((e,t)=>({value:t+1,label:e}))),ze=(0,i.V4)(),Te=[{value:"GENERAL",label:"GENERAL"},{value:"MONTH",label:"MENSUAL"},{value:"INITIAL",label:"INICIAL"}],Ie=(0,s.iH)([]),qe=()=>c(this,void 0,void 0,(function*(){if("GENERAL"===ke.value){const e=`expenses/report/${ke.value}?id_company=${fe}`,t=yield n.http.get(e);Ie.value=t.rows}else if("MONTH"===ke.value){const e=`expenses/report/${ke.value}?id_company=${fe}&year=${Ue.value}&month=${Ne.value}`,t=yield n.http.get(e);Ie.value=t.rows}else{const e=`flows?id_company=${fe}&type=${ke.value}`,t=yield n.http.get(e);Ie.value=t.rows}})),Ee=()=>{let e=Ue.value,t=Ne.value+1;t>12&&(e++,t=1),Ne.value=t,Ue.value=e},Fe=()=>{let e=Ue.value,t=Ne.value-1;0===t&&(e--,t=12),Ne.value=t,Ue.value=e},Ae=(0,a.Fl)((()=>{const e={previous:0,entry:0,tithe:0,entryTotal:0,expense:0,subtotal:0,total:0};return Ie.value.forEach((t=>{e.previous+=t.previous?Number(t.previous):0,e.entry+=t.entry?Number(t.entry):0,e.tithe+=t.tithe?Number(t.tithe):0,e.entryTotal+=t.entryTotal?Number(t.entryTotal):0,e.expense+=t.expense?Number(t.expense):0,e.subtotal+=t.subtotal?Number(t.subtotal):0,e.total+=t.total?Number(t.total):0})),e})),$e=(0,a.Fl)((()=>Ne.value-2<0?11:Ne.value-2)),Le=()=>c(this,void 0,void 0,(function*(){var e,t,l;const a=document.getElementById("report-flow");if(!a)return;const o=document.getElementById("pdf-church-name"),s=null===o||void 0===o?void 0:o.style.display;o&&(o.style.display="inline"),yield new Promise((e=>setTimeout(e,100)));const n={margin:[10,10,10,10],filename:`flujo-caja-${(null===(l=null===(t=null===(e=u.state.user)||void 0===e?void 0:e.user)||void 0===t?void 0:t.company)||void 0===l?void 0:l.name)||"iglesia"}-${i.e7[Ne.value-1]}-${Ue.value}-${Date.now()}.pdf`,image:{type:"png"},html2canvas:{scale:2.5,useCORS:!0,logging:!1,backgroundColor:"#ffffff"},jsPDF:{unit:"mm",format:"letter",orientation:"landscape"}};try{yield d()().set(n).from(a).save()}finally{o&&(o.style.display=null!==s&&void 0!==s?s:"none")}}));return(0,a.YP)(ke,(()=>c(this,void 0,void 0,(function*(){return yield qe()})))),(0,a.YP)(Ue,(()=>c(this,void 0,void 0,(function*(){return yield qe()})))),(0,a.YP)(Ne,(()=>c(this,void 0,void 0,(function*(){return yield qe()})))),(0,a.wF)((()=>c(this,void 0,void 0,(function*(){yield ye()})))),(e,t)=>{var l,n,r,d;const c=(0,a.up)("q-btn"),fe=(0,a.up)("q-select"),ye=(0,a.up)("q-field"),qe=(0,a.up)("q-icon");return(0,a.wg)(),(0,a.iD)("div",v,[(0,a._)("h2",m,[(0,a.Wm)(c,{icon:"arrow_back",round:"",flat:"",onClick:t[0]||(t[0]=t=>e.$router.push("/treasury/reports"))}),(0,a.Uk)(" Flujo de caja - "),p,(0,a._)("span",_,"Total: "+(0,o.zw)(((0,s.SU)(Ae).total||0).toFixed(2))+" "+(0,o.zw)(null===(l=e.$store.state.user)||void 0===l?void 0:l.user.company.money),1)]),(0,a._)("div",w,[(0,a._)("div",h,[(0,a.Wm)(fe,{filled:"",modelValue:ke.value,"onUpdate:modelValue":t[1]||(t[1]=e=>ke.value=e),options:Te,label:"Tipo","map-options":"","emit-value":""},null,8,["modelValue"])]),(0,a._)("div",g,[(0,a.Wm)(fe,{filled:"",modelValue:Ue.value,"onUpdate:modelValue":t[2]||(t[2]=e=>Ue.value=e),options:(0,s.SU)(ze),label:"GestiÃ³n",disable:"GENERAL"===ke.value||"INITIAL"===ke.value,"map-options":"","emit-value":""},null,8,["modelValue","options","disable"])]),(0,a._)("div",x,[(0,a.Wm)(fe,{filled:"",modelValue:Ne.value,"onUpdate:modelValue":t[3]||(t[3]=e=>Ne.value=e),options:(0,s.SU)(Se),label:"Mes",disable:"GENERAL"===ke.value||"YEAR"===ke.value||"INITIAL"===ke.value,"map-options":"","emit-value":""},null,8,["modelValue","options","disable"])])]),!Ie.value.length||"GENERAL"!==ke.value&&"INITIAL"!==ke.value?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",b,[(0,a._)("h3",f,"Flujo de caja "+(0,o.zw)("GENERAL"===ke.value?"General":"Inicial"),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(Ie.value,(t=>{var l,s;return(0,a.wg)(),(0,a.iD)("div",{class:"col-xs-12 col-sm-6",key:t.id},[(0,a._)("div",y,[(0,a._)("div",U,(0,o.zw)(null===(l=t.department)||void 0===l?void 0:l.name),1),(0,a._)("div",k,[(0,a.Wm)(ye,{standout:"",class:"text-right",dense:"",placeholder:"0",suffix:null===(s=e.$store.state.user)||void 0===s?void 0:s.user.company.money},{control:(0,a.w5)((()=>[(0,a._)("div",N,(0,o.zw)(Number(t.total).toFixed(2)),1)])),_:2},1032,["suffix"])])])])})),128))])),"MONTH"===ke.value?((0,a.wg)(),(0,a.iD)("div",S,[(0,a.Wm)(c,{label:"Anterior",flat:"",icon:"chevron_left",onClick:Fe}),Ne.value>0?((0,a.wg)(),(0,a.iD)("strong",z,(0,o.zw)((0,s.SU)(i.e7)[Ne.value-1].toUpperCase()),1)):(0,a.kq)("",!0),(0,a.Wm)(c,{label:"Siguiente",flat:"","icon-right":"chevron_right",onClick:Ee})])):(0,a.kq)("",!0),Ie.value.length&&"MONTH"===ke.value?((0,a.wg)(),(0,a.iD)("div",T,[(0,a._)("div",I,[(0,a.Wm)(c,{icon:"print","no-caps":"",label:"Imprimir",onClick:Le})]),(0,a._)("div",q,[(0,a._)("h3",E,[(0,a.Uk)(" Flujo de caja "+(0,o.zw)((0,s.SU)(i.e7)[Ne.value-1])+" ",1),(0,a._)("span",F," - "+(0,o.zw)(null===(d=null===(r=null===(n=(0,s.SU)(u).state.user)||void 0===n?void 0:n.user)||void 0===r?void 0:r.company)||void 0===d?void 0:d.name),1)]),(0,a._)("div",A,[(0,a._)("table",$,[(0,a._)("thead",null,[(0,a._)("tr",null,[L,(0,a._)("th",W,[(0,a._)("strong",null,"Saldo "+(0,o.zw)((0,s.SU)(i.e7)[(0,s.SU)($e)]),1)]),(0,a._)("th",D,[(0,a._)("strong",null,[(0,a.Uk)("Ingreso "+(0,o.zw)((0,s.SU)(i.e7)[Ne.value-1]),1),(0,a.Wm)(qe,{name:"add_circle_outline"})])]),(0,a._)("th",G,[(0,a._)("strong",null,[(0,a.Uk)("Gasto "+(0,o.zw)((0,s.SU)(i.e7)[Ne.value-1]),1),(0,a.Wm)(qe,{name:"remove_circle_outline"})])]),(0,a._)("th",C,[(0,a._)("strong",null,"Total "+(0,o.zw)((0,s.SU)(i.e7)[Ne.value-1]),1)]),H])]),(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(Ie.value,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",V,[(0,a._)("span",j,(0,o.zw)(e.name),1)]),(0,a._)("td",R,[(0,a._)("div",M,[(0,a._)("span",O,"Saldo "+(0,o.zw)((0,s.SU)(i.e7)[(0,s.SU)($e)])+":",1),(0,a.Uk)(" "+(0,o.zw)(Number(e.previous).toFixed(2)),1)])]),(0,a._)("td",P,[(0,a._)("div",Y,[(0,a._)("span",Z,[(0,a.Uk)("Ingreso "+(0,o.zw)((0,s.SU)(i.e7)[Ne.value-1]),1),(0,a.Wm)(qe,{name:"add_circle_outline"}),(0,a.Uk)(" :")]),(0,a.Uk)(" "+(0,o.zw)(Number(e.entryTotal).toFixed(2)),1)])]),(0,a._)("td",Q,[(0,a._)("div",B,[(0,a._)("span",K,[(0,a.Uk)("Gasto "+(0,o.zw)((0,s.SU)(i.e7)[Ne.value-1]),1),(0,a.Wm)(qe,{name:"remove_circle_outline"}),(0,a.Uk)(":")]),(0,a.Uk)(" "+(0,o.zw)(Number(e.expense).toFixed(2)),1)])]),(0,a._)("td",J,[(0,a._)("div",X,[(0,a._)("span",ee,"Total "+(0,o.zw)((0,s.SU)(i.e7)[Ne.value-1])+":",1),(0,a.Uk)(" "+(0,o.zw)(Number(e.subtotal).toFixed(2)),1)])]),(0,a._)("td",te,[(0,a._)("div",le,[ae,(0,a.Uk)(),(0,a._)("strong",null,(0,o.zw)(Number(e.total).toFixed(2)),1)])])])))),128))]),(0,a._)("tfoot",null,[(0,a._)("tr",null,[oe,(0,a._)("td",se,[(0,a._)("div",ne,[(0,a._)("span",ie,"Saldo "+(0,o.zw)((0,s.SU)(i.e7)[(0,s.SU)($e)])+":",1),(0,a.Uk)(),(0,a._)("strong",null,(0,o.zw)(Number((0,s.SU)(Ae).previous).toFixed(2)),1)])]),(0,a._)("td",re,[(0,a._)("div",ue,[(0,a._)("span",de,[(0,a.Uk)("Ingreso "),(0,a.Wm)(qe,{name:"add_circle_outline"}),(0,a.Uk)(" :")]),(0,a.Uk)(),(0,a._)("strong",null,(0,o.zw)(Number((0,s.SU)(Ae).entryTotal).toFixed(2)),1)])]),(0,a._)("td",ce,[(0,a._)("div",ve,[(0,a._)("span",me,[(0,a.Uk)("Gasto "),(0,a.Wm)(qe,{name:"remove_circle_outline"}),(0,a.Uk)(":")]),(0,a.Uk)(),(0,a._)("strong",null,(0,o.zw)(Number((0,s.SU)(Ae).expense).toFixed(2)),1)])]),(0,a._)("td",pe,[(0,a._)("div",_e,[we,(0,a.Uk)(),(0,a._)("strong",null,(0,o.zw)(Number((0,s.SU)(Ae).subtotal).toFixed(2)),1)])]),(0,a._)("td",he,[(0,a._)("div",ge,[(0,a._)("span",xe,"Total "+(0,o.zw)((0,s.SU)(i.e7)[Ne.value-1])+":",1),(0,a.Uk)(),(0,a._)("strong",null,(0,o.zw)(Number((0,s.SU)(Ae).total).toFixed(2)),1)])])])])])])])])):0===Ie.value.length&&"MONTH"===ke.value?((0,a.wg)(),(0,a.iD)("div",be,[(0,a.Uk)("No existe datos para el mes de "),(0,a._)("strong",null,(0,o.zw)((0,s.SU)(i.e7)[Ne.value-1]),1),(0,a.Uk)(".")])):(0,a.kq)("",!0)])}}});var ye=l(2165),Ue=l(2448),ke=l(6115),Ne=l(6429),Se=l(4554),ze=l(7518),Te=l.n(ze);const Ie=fe,qe=Ie;Te()(fe,"components",{QBtn:ye.Z,QSelect:Ue.Z,QField:ke.Z,QTable:Ne.Z,QIcon:Se.Z})}}]);