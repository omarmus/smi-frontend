"use strict";(self["webpackChunksmi_frontend"]=self["webpackChunksmi_frontend"]||[]).push([[634],{925:(e,t,a)=>{a.d(t,{e7:()=>o,KS:()=>l,WU:()=>n,Fv:()=>s});const o=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],l=(e,t)=>{const a=new Date(e,t,0).getDate(),o=new Date(e,t-1,1),l=[];for(let n=6-o.getDay(),s=1;n<a;n+=7,s++)l.push({day:n+1,label:`Sábado ${n+1}`,week:s,total:0});return l},n=e=>{if(!e)return null;const t=new Date(e);return[t.getUTCDate(),t.getUTCMonth()+1,t.getUTCFullYear()].join("/")},s=e=>e?[e.split("/")[2],e.split("/")[1],e.split("/")[0]].join("-"):null},8468:(e,t,a)=>{a.d(t,{Z:()=>o,K:()=>l});const o={email:e=>{const t=/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/;return t.test(String(e).toLowerCase())||!e||"El correo no es válido."},url:e=>/[-a-zA-Z0-9@:%_+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_+.~#?&//=]*)?/.test(e)||!e||"Introduzca una URL válida",date:e=>/^((0?[1-9]|[12][0-9]|3[01])[- /.](0?[1-9]|1[012])[- /.](19|20)?[0-9]{2})*$/.test(e)||!e||"Introduzca una fecha válida",password:e=>e.length>=6||!e||"Debe tener al menos 6 carácteres.",required:e=>!!e||"El campo es requerido.",phone:e=>{const t=/^[0-9]/;return t.test(String(e).toLowerCase())&&8===e.length||!e||"Introduzca un numero de celular válido."},alphabet:e=>{const t=/^[a-zñÑáéíóú]/;return t.test(String(e).toLowerCase())||!e||"Solo se permiten letras."},number:e=>{const t=/^\d+$/g;return t.test(String(e))||!e||"Solo se permiten numeros enteros."},decimal:e=>{const t=/^\d*\.?\d*$/g;return t.test(String(e))||!e||"Use el punto (.) para los decimales."}};function l(e){return/^\d*\.?\d*$/.test(e)}},8634:(e,t,a)=>{a.r(t),a.d(t,{default:()=>j});var o=a(3673),l=a(2323),n=a(1959),s=a(9582),r=a(9236),i=a(2993),u=a(4626),c=a(4781),d=a(185),m=a(925),p=a(8468),v=function(e,t,a,o){function l(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function s(e){try{i(o.next(e))}catch(t){n(t)}}function r(e){try{i(o["throw"](e))}catch(t){n(t)}}function i(e){e.done?a(e.value):l(e.value).then(s,r)}i((o=o.apply(e,t||[])).next())}))};const g={class:"container"},f={class:"treasury-title"},w=(0,o.Uk)(" Configuración Caja local - "),b={class:"text-warning"},h={class:"subtitle"},_=(0,o._)("div",{class:"alert alert-info"},[(0,o.Uk)("Para "),(0,o._)("strong",null,"empezar"),(0,o.Uk)(" a registrar la información de tesorería primero necesita seleccionar el "),(0,o._)("strong",null,"MES"),(0,o.Uk)(" en el que empezará a contabilizar los registros de tesorería en el sistema, es decir el "),(0,o._)("strong",null,"siguiente mes"),(0,o.Uk)(" del último libro de tesorería que llenó.")],-1),U={class:"q-pb-md"},k={class:"alert alert-info"},y=(0,o.Uk)("Ahora debe "),S=(0,o._)("strong",null,"llenar los montos de cada departamento",-1),C=(0,o.Uk)(" de su iglesia local que tiene como saldo acumulado hasta "),q=(0,o._)("div",{class:"alert alert-info"},[(0,o._)("strong",null,"Importante.-"),(0,o.Uk)(" Use el punto "),(0,o._)("strong",null,"."),(0,o.Uk)(" como separador decimal para los centavos en todo el sistema. "),(0,o._)("em",null,"Ejemplo: 132.5")],-1),z={class:"row flow-items q-col-gutter-x-lg q-pt-md"},D={class:"row q-pb-xs"},x={class:"col-8 q-pb-lg"},I={class:"col-xs-4 col-sm-4"},$={class:"text-right q-pt-lg"},A=(0,o.aZ)({setup(e){var t,a;const A=(0,s.tv)(),Z=(0,r.useStore)(),E=(0,n.iH)([]),F=(0,n.iH)(),L=(0,n.iH)(),V=null===(a=null===(t=Z.state.user)||void 0===t?void 0:t.user)||void 0===a?void 0:a.company.id,T=()=>v(this,void 0,void 0,(function*(){const e=yield i.http.get("departments?order=id&type=LOCAL");E.value=e.rows})),j=()=>v(this,void 0,void 0,(function*(){const e=yield i.http.get(`flows?id_company=${V}&type=INITIAL`);e.count?(E.value=e.rows.map((e=>({id:e.department.id,name:e.department.name,total:e.total}))),F.value=!0,L.value=e.rows[0].month):yield T()})),H=()=>0===E.value.reduce(((e,t)=>e+(t.total||0)),0)?u.message.warning("Debe llenar por lo menos un monto de algún departamento para continuar"):E.value.reduce(((e,t)=>e&&(!t.total||(0,p.K)(t.total))),!0)?void(0,d.Confirm)("<p>Revise que los datos ingresados sean correctos, solo podrá configurar esta información una única vez.<p> ¿Deséa continuar?",(()=>v(this,void 0,void 0,(function*(){return yield i.http.post("flows/initial",{id_company:V,departments:E.value,month:L.value}),u.message.success("Configuración guardada correctamente"),c.storage.set("initial",!1),Z.commit("global/setInitial",!1),A.push("/treasury")}))),null,"Advertencia","Si, continuar"):u.message.warning("- El formato del monto no es válido, use el punto decimal como separador de decimales,<br>- Tampoco puede usar las comas como separador de miles"),K=(0,n.Fl)((()=>{let e=0;return E.value.forEach((t=>{e+=Number(t.total||0)})),e.toFixed(2)})),M=(0,n.Fl)((()=>L.value>1?m.e7[L.value-2].toUpperCase():m.e7[11].toUpperCase()));return(0,o.wF)((()=>v(this,void 0,void 0,(function*(){yield j()})))),(e,t)=>{var a,s;const r=(0,o.up)("q-btn"),i=(0,o.up)("q-select"),u=(0,o.up)("q-input");return(0,o.wg)(),(0,o.iD)("div",g,[(0,o._)("h2",f,[(0,o.Wm)(r,{icon:"arrow_back",round:"",flat:"",onClick:t[0]||(t[0]=t=>e.$router.push("/"))}),w,(0,o._)("span",b,(0,l.zw)(null===(s=null===(a=e.$store.state.user)||void 0===a?void 0:a.user)||void 0===s?void 0:s.company.name),1),(0,o._)("span",h,"Total: "+(0,l.zw)((0,n.SU)(K))+" Bs.",1)]),_,(0,o._)("div",U,[(0,o.Wm)(i,{modelValue:L.value,"onUpdate:modelValue":t[1]||(t[1]=e=>L.value=e),options:(0,n.SU)(m.e7).map(((e,t)=>({value:t+1,label:e.toUpperCase()}))),label:"Seleccione el mes","emit-value":"","map-options":"",filled:"",disable:F.value,rules:[e=>!!e||"Debe seleccionar el mes para continuar"]},null,8,["modelValue","options","disable","rules"])]),L.value?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o._)("div",k,[y,S,C,(0,o._)("strong",null,(0,l.zw)((0,n.SU)(M)),1)]),q,(0,o._)("div",z,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(E.value,(e=>((0,o.wg)(),(0,o.iD)("div",{class:"col-xs-12 col-sm-6",key:e.id},[(0,o._)("div",D,[(0,o._)("div",x,(0,l.zw)(e.name),1),(0,o._)("div",I,[(0,o.Wm)(u,{standout:"",class:"text-right",dense:"",placeholder:"0.0",suffix:"Bs.",modelValue:e.total,"onUpdate:modelValue":t=>e.total=t,disable:F.value,rules:[(0,n.SU)(p.Z).decimal]},null,8,["modelValue","onUpdate:modelValue","disable","rules"])])])])))),128))]),(0,o._)("div",$,[F.value?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(r,{key:0,label:"Guardar configuración inicial","no-caps":"",color:"primary",icon:"check",padding:"10px 20px",class:"btn-close-month",onClick:H}))])],64)):(0,o.kq)("",!0)])}}});var Z=a(8240),E=a(2448),F=a(4842),L=a(7518),V=a.n(L);const T=A,j=T;V()(A,"components",{QBtn:Z.Z,QSelect:E.Z,QInput:F.Z})}}]);