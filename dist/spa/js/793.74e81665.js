"use strict";(globalThis["webpackChunksmi_frontend"]=globalThis["webpackChunksmi_frontend"]||[]).push([[793],{3793:(e,l,t)=>{t.r(l),t.d(l,{default:()=>Y});var o=t(3673),s=t(1959),a=t(2323),i=t(4220),n=t(2993),u=t(4781),r=t(8339),d=t(8719),v=t(9236),c=function(e,l,t,o){function s(e){return e instanceof t?e:new t((function(l){l(e)}))}return new(t||(t=Promise))((function(t,a){function i(e){try{u(o.next(e))}catch(l){a(l)}}function n(e){try{u(o["throw"](e))}catch(l){a(l)}}function u(e){e.done?t(e.value):s(e.value).then(i,n)}u((o=o.apply(e,l||[])).next())}))};const p=(0,o._)("div",{class:"layout-menu"},[(0,o._)("h1",{class:"header-icon"}," Secretaría & Tesorería ")],-1),m={class:"personal q-ma-md"},h=["src","alt"],w={key:1},g={class:"personal-datos"},f={class:"personal-name"},y={class:"personal-company"},b=(0,o.aZ)({__name:"Menu",setup(e){var l,t,b,_,k,q,S,Z,Q;const W=(0,v.o)(),I=(0,r.tv)(),T=(0,s.iH)(),R=(0,s.iH)(),$=(0,s.iH)([]),C=(0,s.iH)(),A=(0,s.iH)(),x=Number(null===(b=null===(t=null===(l=W.state.user)||void 0===l?void 0:l.user)||void 0===t?void 0:t.company)||void 0===b?void 0:b.id),U=[d.j.SUPERADMINISTRATOR].includes(null===(q=null===(k=null===(_=null===W||void 0===W?void 0:W.state)||void 0===_?void 0:_.user)||void 0===k?void 0:k.role)||void 0===q?void 0:q.slug),j=[d.j.ADMINISTRATOR_UNION,d.j.ADMINISTRATOR_ASSOCIATION].includes(null===(Q=null===(Z=null===(S=null===W||void 0===W?void 0:W.state)||void 0===S?void 0:S.user)||void 0===Z?void 0:Z.role)||void 0===Q?void 0:Q.slug);function D(){i.auth.logout("store")}const H=e=>"/treasury/entryexpense/"===e.path?E():I.push(e.path),E=()=>c(this,void 0,void 0,(function*(){const e=u.storage.get("initial");if(e)return I.push("/treasury/flows/initial");C.value=yield n.http.get(`entries/year/${V}/${x}`),A.value=yield n.http.get(`expenses/year/${V}/${x}`);const l=C.value.rows.find((e=>"ACTIVE"===e.state)),t=A.value.rows.find((e=>"ACTIVE"===e.state));return l&&t?I.push(`/treasury/entryexpense/${String(l.id)}/${String(t.id)}`):I.push("/treasury/months")})),V=(new Date).getUTCFullYear();(0,o.YP)(T,(()=>c(this,void 0,void 0,(function*(){if("number"===typeof T.value){const e=yield n.http.get(`auth/token/${T.value}`);return u.storage.set("role",e.role),u.storage.set("menu",e.menu),u.storage.set("permissions",e.permissions),u.storage.set("token",e.token),i.auth.initStore(),M(),I.push("/")}}))));const M=()=>{var e,l,t,o,s,a,i,n,r,d,v,c,p,m,h,w,g,f,y,b,_;R.value=W.state.user.roles,T.value=W.state.user.role;const k=u.storage.get("initial");if($.value=[],!["TREASURER"].includes(null===(e=W.state.user.role)||void 0===e?void 0:e.slug)){const e={path:"/secretary",label:"Secretaría",icon:"edit_note",items:[]};(null===(t=null===(l=W.state.user)||void 0===l?void 0:l.permissions)||void 0===t?void 0:t.includes("company:read"))&&(null===(o=e.items)||void 0===o||o.push({path:"/secretary/churchs",label:"Iglesias"})),(null===(a=null===(s=W.state.user)||void 0===s?void 0:s.permissions)||void 0===a?void 0:a.includes("user:read"))&&(null===(i=e.items)||void 0===i||i.push({path:"/secretary/members",label:"Miembros y usuarios"})),(null===(r=null===(n=W.state.user)||void 0===n?void 0:n.permissions)||void 0===r?void 0:r.includes("department:read"))&&(U||j)&&(null===(d=e.items)||void 0===d||d.push({path:"/secretary/departments",label:"Departamentos"})),$.value.push(e)}if(!["SECRETARY"].includes(null===(c=null===(v=W.state.user)||void 0===v?void 0:v.role)||void 0===c?void 0:c.slug)){const e={path:"/treasury",label:"Tesorería",icon:"monetization_on",items:[]};(null===(m=null===(p=W.state.user)||void 0===p?void 0:p.permissions)||void 0===m?void 0:m.includes("entry:read"))&&(null===(h=e.items)||void 0===h||h.push({path:"/treasury/entryexpense/",label:"Ingresos y Gastos"})),(null===(g=null===(w=W.state.user)||void 0===w?void 0:w.permissions)||void 0===g?void 0:g.includes("account:read"))&&!k&&(null===(f=e.items)||void 0===f||f.push({path:"/treasury/accounts",label:"Cuentas bancarias"})),(null===(b=null===(y=W.state.user)||void 0===y?void 0:y.permissions)||void 0===b?void 0:b.includes("balance:read"))&&!k&&(null===(_=e.items)||void 0===_||_.push({path:"/treasury/reports",label:"Reportes"})),$.value.push(e)}};return(0,o.bv)((()=>{M()})),(e,l)=>{const t=(0,o.up)("q-avatar"),i=(0,o.up)("q-separator"),u=(0,o.up)("q-select"),r=(0,o.up)("q-item-section"),d=(0,o.up)("q-item"),v=(0,o.up)("q-list"),c=(0,o.up)("q-expansion-item"),b=(0,o.up)("q-icon"),_=(0,o.up)("q-scroll-area"),k=(0,o.Q2)("ripple");return(0,o.wg)(),(0,o.j4)(_,{class:"fit"},{default:(0,o.w5)((()=>{var _,q,S,Z,Q,W;return[p,(0,o._)("div",m,[(0,o.Wm)(t,{size:"48px",color:"white"},{default:(0,o.w5)((()=>{var l,t,i,u,r,d,v,c,p,m,g;return[(null===(t=null===(l=e.$store.state.user)||void 0===l?void 0:l.user)||void 0===t?void 0:t.photo)?((0,o.wg)(),(0,o.iD)("img",{key:0,src:`${null===(i=(0,s.SU)(n.urlBase))||void 0===i?void 0:i.replace(/\/api\//g,"")}/files/users/${null===(r=null===(u=e.$store.state.user)||void 0===u?void 0:u.user)||void 0===r?void 0:r.photo}`,alt:null===(c=null===(v=null===(d=e.$store.state.user)||void 0===d?void 0:d.user)||void 0===v?void 0:v.username)||void 0===c?void 0:c.substring(0,2).toUpperCase()},null,8,h)):((0,o.wg)(),(0,o.iD)("span",w,(0,a.zw)(null===(g=null===(m=null===(p=e.$store.state.user)||void 0===p?void 0:p.user)||void 0===m?void 0:m.username)||void 0===g?void 0:g.substring(0,2).toUpperCase()),1))]})),_:1}),(0,o._)("div",g,[(0,o._)("div",f,(0,a.zw)(null===(q=null===(_=e.$store.state.user)||void 0===_?void 0:_.user)||void 0===q?void 0:q.fullname),1),(0,o._)("div",y,(0,a.zw)(null===(Q=null===(Z=null===(S=e.$store.state.user)||void 0===S?void 0:S.user)||void 0===Z?void 0:Z.company)||void 0===Q?void 0:Q.name),1)])]),(0,o.Wm)(i),R.value&&(null===(W=R.value)||void 0===W?void 0:W.length)>1?((0,o.wg)(),(0,o.j4)(u,{key:0,square:"",standout:"",color:"teal",label:"Rol seleccionado",modelValue:T.value,"onUpdate:modelValue":l[0]||(l[0]=e=>T.value=e),options:R.value,"option-value":"id","option-label":"name","emit-value":"","map-options":"",dark:""},null,8,["modelValue","options"])):(0,o.kq)("",!0),(0,o.Wm)(i),(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)($.value,(l=>((0,o.wg)(),(0,o.j4)(c,{group:"somegroup",icon:l.icon,label:l.label,"header-class":"text-white menu-list",key:l.path},{default:(0,o.w5)((()=>[l.items?((0,o.wg)(),(0,o.j4)(v,{key:0,padding:"",class:"menu-list menu-sublist"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.items,(l=>(0,o.wy)(((0,o.wg)(),(0,o.j4)(d,{key:l.path,onClick:e=>H(l),active:-1!==e.$route.path.indexOf(l.path),clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{avatar:"",class:"layout-menu-icon"}),(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(l.label),1)])),_:2},1024)])),_:2},1032,["onClick","active"])),[[k]]))),128))])),_:2},1024)):(0,o.kq)("",!0)])),_:2},1032,["icon","label"])))),128))])),_:1}),(0,o.Wm)(i),(0,o.Wm)(v,{padding:"",class:"menu-list"},{default:(0,o.w5)((()=>[(0,o.wy)(((0,o.wg)(),(0,o.j4)(d,{onClick:D,clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{avatar:"",class:"layout-menu-icon"},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{name:"logout",class:"color-texto"})])),_:1}),(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Uk)("Salir de sistema")])),_:1})])),_:1})),[[k]])])),_:1})]})),_:1})}}});var _=t(7704),k=t(2165),q=t(5096),S=t(5869),Z=t(2448),Q=t(7011),W=t(3414),I=t(2035),T=t(4554),R=t(4615),$=t(6489),C=t(7518),A=t.n(C);const x=b,U=x;A()(b,"components",{QScrollArea:_.Z,QBtn:k.Z,QAvatar:q.Z,QSeparator:S.Z,QSelect:Z.Z,QList:Q.Z,QItem:W.Z,QItemSection:I.Z,QIcon:T.Z,QExpansionItem:R.Z}),A()(b,"directives",{Ripple:$.Z});const j={__name:"MainLayout",setup(e){const l=(0,s.iH)(!1);function t(){l.value=!l.value}return(e,a)=>{const i=(0,o.up)("q-btn"),n=(0,o.up)("q-space"),u=(0,o.up)("q-toolbar"),r=(0,o.up)("q-header"),d=(0,o.up)("q-drawer"),v=(0,o.up)("router-view"),c=(0,o.up)("q-page-container"),p=(0,o.up)("q-layout");return(0,o.wg)(),(0,o.j4)(p,{view:"lHh lpR lFf"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{class:"q-header-main"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o.Wm)(i,{flat:"",dense:"",round:"",class:"warning-light",icon:"menu","aria-label":"Menu",onClick:t}),(0,o.Wm)(n)])),_:1})])),_:1}),(0,o.Wm)(d,{"show-if-above":"",modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value=e),side:"left",bordered:"",width:270,class:"sidebar"},{default:(0,o.w5)((()=>[(0,o.Wm)((0,s.SU)(U))])),_:1},8,["modelValue"]),(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v)])),_:1})])),_:1})}}};var D=t(9214),H=t(3812),E=t(9570),V=t(2025),M=t(2901),N=t(2652),O=t(1762);const z=j,Y=z;A()(j,"components",{QLayout:D.Z,QHeader:H.Z,QToolbar:E.Z,QBtn:k.Z,QIcon:T.Z,QSpace:V.Z,QDrawer:M.Z,QPageContainer:N.Z,QFooter:O.Z})}}]);