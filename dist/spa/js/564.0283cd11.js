"use strict";(self["webpackChunksmi_frontend"]=self["webpackChunksmi_frontend"]||[]).push([[564],{925:(e,l,t)=>{t.d(l,{e7:()=>a,KS:()=>o,WU:()=>n,Fv:()=>u});const a=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],o=(e,l)=>{const t=new Date(e,l,0).getDate(),a=new Date(e,l-1,1),o=[];for(let n=6-a.getDay(),u=1;n<t;n+=7,u++)o.push({day:n+1,label:`Sábado ${n+1}`,week:u,total:0});return o},n=e=>{if(!e)return null;const l=new Date(e);return[l.getUTCDate(),l.getUTCMonth()+1,l.getUTCFullYear()].join("/")},u=e=>e?[e.split("/")[2],e.split("/")[1],e.split("/")[0]].join("-"):null},564:(e,l,t)=>{t.r(l),t.d(l,{default:()=>pe});var a=t(3673),o=t(2323),n=t(1959),u=t(9582),s=t(2993),i=t(185),d=t(925),r=function(e,l,t,a){function o(e){return e instanceof t?e:new t((function(l){l(e)}))}return new(t||(t=Promise))((function(t,n){function u(e){try{i(a.next(e))}catch(l){n(l)}}function s(e){try{i(a["throw"](e))}catch(l){n(l)}}function i(e){e.done?t(e.value):o(e.value).then(u,s)}i((a=a.apply(e,l||[])).next())}))};const c={key:0,class:"container"},p={class:"treasury-title"},m={key:0,class:"text-warning"},v={class:"subtitle"},y={class:"row"},_={key:0,class:"col-xs-12 col-sm-6"},f={class:"col-xs-12"},w={class:"treasury-department-total"},b={class:"col-xs-12"},h={class:"col-xs-12"},g={class:"row items-center justify-end"},k={class:"col-xs-12"},x=(0,a._)("h3",{class:"text-secondary treasury-subtitle q-px-md"},"Datos de la factura, recibo...",-1),D={class:"col-xs-12"},q={class:"col-xs-12"},C={class:"col-xs-12"},V={class:"col-xs-12"},U={class:"q-table-simple q-table__container q-table--horizontal-separator column no-wrap q-table--dense q-table--no-wrap"},O={key:0,class:"text-left"},T=(0,a._)("th",{class:"text-left"},[(0,a._)("strong",null,"Descripción")],-1),W={key:1,class:"text-left"},S=(0,a._)("strong",null,"Datos de facturación",-1),z=[S],E=(0,a._)("th",{class:"text-right"},[(0,a._)("strong",null,"Valor")],-1),L={key:0,class:"width-80"},A={class:"text-left"},$={class:"treasury-departament"},Z={key:1,class:"text-left"},F={class:"treasury-list-concepts"},Q={key:0},R=(0,a._)("strong",null,"Tipo de documento:",-1),I={key:1},H=(0,a._)("strong",null,"Número de documento:",-1),N={key:2},P=(0,a._)("strong",null,"Proveedor:",-1),j={class:"text-right total"},B=(0,a._)("th",{class:"text-left",colspan:"2"},[(0,a._)("strong",null,"Total")],-1),G={class:"text-right"},M={class:"text-right q-pt-xs q-gutter-xs"},Y=(0,a.aZ)({setup(e){const l=[{value:"FACTURA",label:"FACTURA"},{value:"RECIBO",label:"RECIBO"},{value:"NOTA DE VENTA",label:"NOTA DE VENTA"},{value:"OTRO",label:"OTRO"}],t=9,S=(0,n.iH)([]),Y=(0,n.iH)([]),J=(0,n.iH)([]),K=(0,n.iH)(!0),X=(0,n.iH)({id:null,date:null,value:"",concept:"",documentType:"",document_number:"",supplier:"",expense:null,department:null,idDepartment:null}),ee=(0,n.iH)(),le=(0,n.iH)(),te=(0,n.iH)([]),ae=(0,u.yj)(),{expenseId:oe}=ae.params,ne=()=>r(this,void 0,void 0,(function*(){ee.value=yield s.http.get("expenses/"+ +oe)})),ue=()=>r(this,void 0,void 0,(function*(){const e=yield s.http.get("departments?order=id&type=LOCAL");return e.rows.map((e=>{var l;return{value:e.id,type:"GLOBAL"===e.type?"Asociación":"Iglesia local",label:e.name,group:e.group,total:(null===(l=Y.value.find((l=>l.department.id===e.id)))||void 0===l?void 0:l.total)||0}}))})),se=()=>r(this,void 0,void 0,(function*(){const e=yield s.http.get(`flows?id_company=${t}&type=GENERAL`);Y.value=e.rows})),ie=(e,l)=>{l((()=>{if(""===e)J.value=S.value;else{const l=e.toLowerCase();J.value=S.value.filter((e=>e.label.toLowerCase().indexOf(l)>-1))}}))},de=()=>r(this,void 0,void 0,(function*(){X.value.id_expense=ee.value.id,X.value.document_type=X.value.documentType.value,X.value.id_department=X.value.idDepartment.value,X.value.id?yield s.http.put(`expenses/details/${X.value.id}`,X.value):yield s.http.post("expenses/details",X.value),yield me(),yield pe()})),re=e=>r(this,void 0,void 0,(function*(){X.value=yield s.http.get(`expenses/details/${e}`),X.value.idDepartment={value:X.value.department.id,label:X.value.department.name},X.value.documentType={value:X.value.document_type,label:X.value.document_type}})),ce=e=>{(0,i.Confirm)("¿Desea eliminar el registro?",(()=>r(this,void 0,void 0,(function*(){yield s.http["delete"](`expenses/details/${e}`),yield me()}))))},pe=()=>r(this,void 0,void 0,(function*(){K.value=!1,yield(0,a.Y3)((()=>{X.value={id:null,date:null,value:"",concept:"",documentType:"",document_number:"",supplier:"",expense:null,department:null,idDepartment:null},K.value=!0}))})),me=()=>r(this,void 0,void 0,(function*(){const e=yield s.http.get(`expenses/details?id_expense=${ee.value.id}`);te.value=e.rows})),ve=()=>r(this,void 0,void 0,(function*(){const e=yield s.http.get(`entries?year=${ee.value.year}&month=${ee.value.month}&id_company=${t}`);e.count&&(le.value=e.rows[0])})),ye=(0,n.Fl)((()=>{let e=0;for(const l of te.value)e+=parseFloat(l.value);return e}));return(0,a.wF)((()=>r(this,void 0,void 0,(function*(){yield se(),S.value=yield ue(),yield ne(),yield me(),yield ve()})))),(e,t)=>{const u=(0,a.up)("q-btn"),s=(0,a.up)("q-item-label"),i=(0,a.up)("q-item-section"),r=(0,a.up)("q-item"),S=(0,a.up)("q-select"),Y=(0,a.up)("q-input"),ae=(0,a.up)("q-date"),oe=(0,a.up)("q-popup-proxy"),ne=(0,a.up)("q-icon"),ue=(0,a.up)("q-form"),se=(0,a.Q2)("close-popup");return ee.value?((0,a.wg)(),(0,a.iD)("div",c,[(0,a._)("h2",p,[(0,a.Wm)(u,{icon:"arrow_back",round:"",flat:"",onClick:t[0]||(t[0]=l=>e.$router.push(`/treasury/entryexpense/${le.value.id}/${e.$route.params.expenseId}`))}),(0,a.Uk)(" Gastos - "+(0,o.zw)((0,n.SU)(d.e7)[ee.value.month-1])+" ",1),"CLOSED"===ee.value.state?((0,a.wg)(),(0,a.iD)("span",m," CERRADO")):(0,a.kq)("",!0),(0,a._)("span",v,"Total: "+(0,o.zw)((0,n.SU)(ye))+" Bs.",1)]),(0,a._)("div",y,["CLOSED"!==ee.value.state?((0,a.wg)(),(0,a.iD)("div",_,[K.value?((0,a.wg)(),(0,a.j4)(ue,{key:0,onSubmit:de,onReset:pe,class:"q-gutter-md"},{default:(0,a.w5)((()=>[(0,a._)("div",f,[(0,a.Wm)(S,{filled:"",label:"Departamento",modelValue:X.value.idDepartment,"onUpdate:modelValue":t[1]||(t[1]=e=>X.value.idDepartment=e),"use-input":"","use-chips":"","input-debounce":"0",options:J.value,onFilter:ie,"lazy-rules":"",rules:[e=>!!e||"Seleccione el departamento"]},{option:(0,a.w5)((e=>[(0,a.Wm)(r,(0,o.vs)((0,a.F4)(e.itemProps)),{default:(0,a.w5)((()=>[(0,a.Wm)(i,{class:"treasury-department-item"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.label),1)])),_:2},1024),(0,a.Wm)(s,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.opt.type),1)])),_:2},1024),(0,a._)("span",w,(0,o.zw)(e.opt.total)+" Bs.",1)])),_:2},1024)])),_:2},1040)])),_:1},8,["modelValue","options","rules"])]),(0,a._)("div",b,[(0,a.Wm)(Y,{filled:"",label:"Concepto",modelValue:X.value.concept,"onUpdate:modelValue":t[2]||(t[2]=e=>X.value.concept=e),rules:[e=>!!e||"Debe llenar el concepto"]},null,8,["modelValue","rules"])]),(0,a._)("div",h,[(0,a.Wm)(Y,{label:"Fecha",filled:"",modelValue:X.value.date,"onUpdate:modelValue":t[4]||(t[4]=e=>X.value.date=e),mask:"date",rules:["date",e=>!!e||"Debe seleccionar una fecha"]},{append:(0,a.w5)((()=>[(0,a.Wm)(ne,{name:"event",class:"cursor-pointer"},{default:(0,a.w5)((()=>[(0,a.Wm)(oe,{ref:"qDateProxy",cover:"","transition-show":"scale","transition-hide":"scale"},{default:(0,a.w5)((()=>[(0,a.Wm)(ae,{modelValue:X.value.date,"onUpdate:modelValue":t[3]||(t[3]=e=>X.value.date=e)},{default:(0,a.w5)((()=>[(0,a._)("div",g,[(0,a.wy)((0,a.Wm)(u,{label:"Close",color:"primary",flat:""},null,512),[[se]])])])),_:1},8,["modelValue"])])),_:1},512)])),_:1})])),_:1},8,["modelValue","rules"])]),(0,a._)("div",k,[(0,a.Wm)(Y,{filled:"",label:"Valor",modelValue:X.value.value,"onUpdate:modelValue":t[5]||(t[5]=e=>X.value.value=e),rules:[e=>!!e||"Debe llenar el valor"]},null,8,["modelValue","rules"])]),x,(0,a._)("div",D,[(0,a.Wm)(S,{filled:"",label:"Tipo de documento",modelValue:X.value.documentType,"onUpdate:modelValue":t[6]||(t[6]=e=>X.value.documentType=e),options:l},null,8,["modelValue"])]),(0,a._)("div",q,[(0,a.Wm)(Y,{filled:"",label:"Número de documento",modelValue:X.value.document_number,"onUpdate:modelValue":t[7]||(t[7]=e=>X.value.document_number=e)},null,8,["modelValue"])]),(0,a._)("div",C,[(0,a.Wm)(Y,{filled:"",label:"Proveedor",modelValue:X.value.supplier,"onUpdate:modelValue":t[8]||(t[8]=e=>X.value.supplier=e)},null,8,["modelValue"])]),(0,a._)("div",V,[X.value.id?((0,a.wg)(),(0,a.j4)(u,{key:0,type:"reset",padding:"10px",label:"Cancelar","no-caps":"",icon:"cancel",class:"full-width q-mb-sm"})):(0,a.kq)("",!0),(0,a.Wm)(u,{type:"submit",padding:"10px",label:X.value.id?"Actualizar":"Registrar",color:"primary","no-caps":"",icon:"check",class:"full-width"},null,8,["label"])])])),_:1})):(0,a.kq)("",!0)])):(0,a.kq)("",!0),(0,a._)("div",{class:(0,o.C_)(["col-xs-12 tithe-column",{"col-sm-6":"CLOSED"!==ee.value.state,"col-sm-12":"CLOSED"===ee.value.state}])},[(0,a._)("div",U,[(0,a._)("table",{class:(0,o.C_)(["q-table",{"treasury-table-data":"CLOSED"===ee.value.state}])},[(0,a._)("thead",null,[(0,a._)("tr",null,["CLOSED"!==ee.value.state?((0,a.wg)(),(0,a.iD)("th",O)):(0,a.kq)("",!0),T,"CLOSED"===ee.value.state?((0,a.wg)(),(0,a.iD)("th",W,z)):(0,a.kq)("",!0),E])]),(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(te.value,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},["CLOSED"!==ee.value.state?((0,a.wg)(),(0,a.iD)("td",L,[(0,a.Wm)(u,{size:"sm",icon:"edit",round:"",flat:"",onClick:l=>re(e.id)},null,8,["onClick"]),(0,a.Wm)(u,{size:"sm",icon:"delete",round:"",flat:"",onClick:l=>ce(e.id)},null,8,["onClick"])])):(0,a.kq)("",!0),(0,a._)("td",A,[(0,a.Uk)((0,o.zw)(e.concept)+" ",1),(0,a._)("strong",$,(0,o.zw)(e.department.name),1),(0,a._)("em",null,"Registrado el "+(0,o.zw)((0,n.SU)(d.WU)(e.date)),1)]),"CLOSED"===ee.value.state?((0,a.wg)(),(0,a.iD)("td",Z,[(0,a._)("ul",F,[e.document_type?((0,a.wg)(),(0,a.iD)("li",Q,[R,(0,a.Uk)(" "+(0,o.zw)(e.document_type),1)])):(0,a.kq)("",!0),e.document_number?((0,a.wg)(),(0,a.iD)("li",I,[H,(0,a.Uk)(" "+(0,o.zw)(e.document_number),1)])):(0,a.kq)("",!0),e.supplier?((0,a.wg)(),(0,a.iD)("li",N,[P,(0,a.Uk)(" "+(0,o.zw)(e.supplier),1)])):(0,a.kq)("",!0)])])):(0,a.kq)("",!0),(0,a._)("td",j,(0,o.zw)(e.value),1)])))),128))]),(0,a._)("tfoot",null,[(0,a._)("tr",null,[B,(0,a._)("th",G,[(0,a._)("strong",null,(0,o.zw)((0,n.SU)(ye)),1)])])])],2)]),(0,a._)("div",M,[le.value?((0,a.wg)(),(0,a.j4)(u,{key:0,label:"Ver ingresos del mes","no-caps":"",icon:"attach_money",padding:"10px 20px",class:"btn-close-month",onClick:t[9]||(t[9]=l=>e.$router.push(`/treasury/week/${le.value.id}`))})):(0,a.kq)("",!0)])],2)])])):(0,a.kq)("",!0)}}});var J=t(8240),K=t(5269),X=t(2448),ee=t(3414),le=t(2035),te=t(2350),ae=t(4689),oe=t(4554),ne=t(3944),ue=t(6915),se=t(6429),ie=t(677),de=t(7518),re=t.n(de);const ce=Y,pe=ce;re()(Y,"components",{QBtn:J.Z,QForm:K.Z,QSelect:X.Z,QItem:ee.Z,QItemSection:le.Z,QItemLabel:te.Z,QInput:ae.Z,QIcon:oe.Z,QPopupProxy:ne.Z,QDate:ue.Z,QTable:se.Z}),re()(Y,"directives",{ClosePopup:ie.Z})}}]);