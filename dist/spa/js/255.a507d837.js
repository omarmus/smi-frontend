"use strict";(globalThis["webpackChunksmi_frontend"]=globalThis["webpackChunksmi_frontend"]||[]).push([[255],{9255:(e,l,a)=>{a.r(l),a.d(l,{default:()=>T});var t=a(3673),o=a(1959),r=a(2323),i=a(2993),n=a(925),s=a(8339),u=a(185),d=function(e,l,a,t){function o(e){return e instanceof a?e:new a((function(l){l(e)}))}return new(a||(a=Promise))((function(a,r){function i(e){try{s(t.next(e))}catch(l){r(l)}}function n(e){try{s(t["throw"](e))}catch(l){r(l)}}function s(e){e.done?a(e.value):o(e.value).then(i,n)}s((t=t.apply(e,l||[])).next())}))};const c={class:"container"},v={class:"treasury-title"},m={key:0,class:"alert alert-info"},p=(0,t._)("strong",null,"mes, gestión y trimestre",-1),f={key:1,class:"row q-col-gutter-sm"},h={class:"col-xs-12 col-sm-4"},k={class:"col-xs-12 col-sm-4"},y={class:"col-xs-12 col-sm-4"},b={class:"text-right q-mt-xs col-xs-12"},w={key:2,class:"row treasury-row"},g={class:"text-right q-mb-md col-xs-12"},_={class:"btn-block-detail"},q={class:"text-warning"},x={class:"btn-block-detail"},U={class:"text-primary"},V=(0,t.aZ)({__name:"Quarter",setup(e){const l=[{value:1,label:"1er. trimestre"},{value:2,label:"2do. trimestre"},{value:3,label:"3er. trimestre"},{value:4,label:"4to. trimestre"}],a=(0,s.tv)(),V=(0,o.iH)(),C=(0,o.iH)(),R=(0,o.iH)((new Date).getFullYear()),D=(0,o.iH)(1),S=(0,o.iH)(1),H=(0,o.iH)(!1),I=(0,o.iH)(!1),T=n.e7.map(((e,l)=>({value:l+1,label:e}))),E=(0,n.V4)(),W=()=>{(0,u.Confirm)("Va a crear el <strong>PRIMER INFORME TRIMESTRAL</strong>, esta operación se hará una única vez y no podrá revertirlo. ¿Deséa continuar?.",(()=>d(this,void 0,void 0,(function*(){var e;V.value=yield i.http.post("expenses/report/quarter",{month:D.value,year:R.value,quarter:S.value}),(null===(e=V.value)||void 0===e?void 0:e.id)&&(yield M(),a.push(`/treasury/report/quarter/${V.value.id}`))}))),void 0,"Advertencia","Continuar")},A=()=>{(0,u.Confirm)("Va a crear el <strong>SIGUIENTE INFORME TRIMESTRAL</strong>. ¿Deséa continuar?.",(()=>d(this,void 0,void 0,(function*(){var e;V.value=yield i.http.post("expenses/report/quarter/next"),(null===(e=V.value)||void 0===e?void 0:e.id)&&(yield M(),a.push(`/treasury/report/quarter/${V.value.id}`))}))),void 0,"Advertencia","Continuar")},M=()=>d(this,void 0,void 0,(function*(){I.value=!0,C.value=yield i.http.get("reports?type=QUARTER&order=-id"),(0,t.Y3)((()=>{I.value=!1}))}));return(0,t.bv)((()=>d(this,void 0,void 0,(function*(){yield M(),H.value=!0})))),(e,a)=>{var i,s,u,d;const V=(0,t.up)("q-btn"),M=(0,t.up)("q-select"),N=(0,t.up)("q-icon");return(0,t.wg)(),(0,t.iD)("div",c,[(0,t._)("h2",v,[(0,t.Wm)(V,{icon:"arrow_back",round:"",flat:"",onClick:a[0]||(a[0]=l=>e.$router.push("/treasury/reports"))}),(0,t.Uk)(" Informe trimestral ")]),H.value?((0,t.wg)(),(0,t.iD)(t.HY,{key:0},[0===(null===(i=C.value)||void 0===i?void 0:i.count)?((0,t.wg)(),(0,t.iD)("div",m,[(0,t.Uk)(" Selecciona el "),p,(0,t.Uk)(" en el que empezarás a generar los informes trimestrales. ")])):(0,t.kq)("",!0),0===(null===(s=C.value)||void 0===s?void 0:s.count)?((0,t.wg)(),(0,t.iD)("div",f,[(0,t._)("div",h,[(0,t.Wm)(M,{filled:"",modelValue:R.value,"onUpdate:modelValue":a[1]||(a[1]=e=>R.value=e),options:(0,o.SU)(E),label:"Gestión","map-options":"",dense:"","emit-value":""},null,8,["modelValue","options"])]),(0,t._)("div",k,[(0,t.Wm)(M,{filled:"",modelValue:D.value,"onUpdate:modelValue":a[2]||(a[2]=e=>D.value=e),options:(0,o.SU)(T),label:"Mes","map-options":"",dense:"","emit-value":""},null,8,["modelValue","options"])]),(0,t._)("div",y,[(0,t.Wm)(M,{filled:"",modelValue:S.value,"onUpdate:modelValue":a[3]||(a[3]=e=>S.value=e),options:l,label:"Trimestre","map-options":"",dense:"","emit-value":""},null,8,["modelValue"])]),(0,t._)("div",b,[(0,t.Wm)(V,{icon:"check","no-caps":"",color:"primary",onClick:W,disable:I.value},{default:(0,t.w5)((()=>[(0,t.Uk)(" Generar primer informe ")])),_:1},8,["disable"])])])):(0,t.kq)("",!0),0!==(null===(u=C.value)||void 0===u?void 0:u.count)?((0,t.wg)(),(0,t.iD)("div",w,[(0,t._)("div",g,[(0,t.Wm)(V,{icon:"check","no-caps":"",color:"primary",onClick:A,disable:I.value},{default:(0,t.w5)((()=>[(0,t.Uk)(" Generar siguiente informe ")])),_:1},8,["disable"])]),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(null===(d=C.value)||void 0===d?void 0:d.rows,(a=>((0,t.wg)(),(0,t.iD)("div",{class:"col-xs-6 col-sm-3 q-pa-sm",key:a.id},[(0,t.Wm)(V,{flat:"",color:"secondary",padding:"lg","no-caps":"",onClick:l=>e.$router.push(`/treasury/report/quarter/${a.id}`),class:"full-width btn-block"},{default:(0,t.w5)((()=>{var e,i;return[(0,t.Uk)((0,r.zw)(l[(null===(e=JSON.parse(a.metadata))||void 0===e?void 0:e.quarter)-1].label)+" ",1),(0,t._)("span",_,[(0,t._)("span",q,(0,r.zw)(null===(i=JSON.parse(a.content))||void 0===i?void 0:i.GLOBAL.entries.header.map((e=>(0,o.SU)(n.sR)[Number(e.split("-")[0])-1])).join(" | ")),1)]),(0,t._)("span",x,[(0,t._)("strong",U,(0,r.zw)(a.month>11?a.year+1:a.year),1)]),(0,t.Wm)(N,{name:"width_normal"})]})),_:2},1032,["onClick"])])))),128))])):(0,t.kq)("",!0)],64)):(0,t.kq)("",!0)])}}});var C=a(2165),R=a(2448),D=a(4554),S=a(7518),H=a.n(S);const I=V,T=I;H()(V,"components",{QBtn:C.Z,QSelect:R.Z,QIcon:D.Z})}}]);