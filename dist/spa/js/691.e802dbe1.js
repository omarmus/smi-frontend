"use strict";(globalThis["webpackChunksmi_frontend"]=globalThis["webpackChunksmi_frontend"]||[]).push([[691],{3691:(e,a,l)=>{l.r(a),l.d(a,{default:()=>O});var n=l(3673),o=l(2323),t=l(1959),u=l(2993),i=l(4626),c=l(4781),s=l(9236),r=l(6872),d=function(e,a,l,n){function o(e){return e instanceof l?e:new l((function(a){a(e)}))}return new(l||(l=Promise))((function(l,t){function u(e){try{c(n.next(e))}catch(a){t(a)}}function i(e){try{c(n["throw"](e))}catch(a){t(a)}}function c(e){e.done?l(e.value):o(e.value).then(u,i)}c((n=n.apply(e,a||[])).next())}))};const m={class:"container"},p={class:"treasury-title"},v=(0,n._)("div",{class:"alert alert-info"}," Agregue las cuentas bancarias de su iglesia local para contabilizarlo con los ingresos de su iglesia. ",-1),b={class:"row treasury-row q-pt-md"},f={class:"q-pb-sm"},w={class:"btn-block-detail"},y={class:"btn-block-detail text-primary"},g={class:"btn-block-detail"},h=(0,n.aZ)({__name:"Accounts",setup(e){var a,l;const h=[{value:"ARS",label:"Peso Argentino (ARS)"},{value:"BOB",label:"Boliviano (BOB)"},{value:"COP",label:"Peso Colombiano (COP)"},{value:"GTQ",label:"Quetzal (GTQ)"},{value:"USD",label:"Dólar (USD)"}],k=(0,s.o)(),_=(0,t.iH)(),q=(0,t.iH)(),C=(0,t.iH)({}),W=(0,t.iH)(!1),Q=null===(l=null===(a=k.state.user)||void 0===a?void 0:a.user)||void 0===l?void 0:l.company.id,Z=()=>d(this,void 0,void 0,(function*(){const e=yield u.http.get(`accounts?id_company=${Q}&order=id`);_.value=e.rows})),z=()=>d(this,void 0,void 0,(function*(){const e=JSON.parse(JSON.stringify(C.value));e.id?(yield u.http.put(`accounts/${e.id}`,{name:e.name,number:e.number,bank:e.bank,currency:e.currency,id_company:Q}),i.message.success("¡Cuenta actualizada!")):(e.id_company=Q,yield u.http.post("accounts",e),i.message.success("¡Cuenta agregada correctamente!")),yield Z(),W.value=!1})),V=e=>d(this,void 0,void 0,(function*(){C.value=e?yield u.http.get(`accounts/${e}`):{name:`Cuenta #${_.value.length+1}`},W.value=!0})),U=(e,a)=>{e.length>2&&a(e,"add-unique")},S=(e,a)=>{a((()=>d(this,void 0,void 0,(function*(){q.value=""===e?[]:yield A(e)}))))},A=e=>d(this,void 0,void 0,(function*(){const a=yield u.http.get(`accounts?bank=${e}&groupby=account.bank`,!1),l={};return a.rows.forEach((e=>l[e.bank]=!0)),Object.keys(l)}));return(0,n.wF)((()=>d(this,void 0,void 0,(function*(){yield Z(),c.storage.exist("create")&&(c.storage.remove("create"),V())})))),(e,a)=>{const l=(0,n.up)("q-btn"),u=(0,n.up)("q-tooltip"),i=(0,n.up)("q-icon"),c=(0,n.up)("q-toolbar-title"),s=(0,n.up)("q-toolbar"),d=(0,n.up)("q-select"),k=(0,n.up)("q-input"),Q=(0,n.up)("q-card-section"),A=(0,n.up)("q-card-actions"),x=(0,n.up)("q-form"),T=(0,n.up)("q-card"),B=(0,n.up)("q-dialog"),D=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.iD)("div",m,[(0,n._)("h2",p,[(0,n.Wm)(l,{icon:"arrow_back",round:"",flat:"",onClick:a[0]||(a[0]=a=>e.$router.push("/treasury"))}),(0,n.Uk)(" Cuentas bancarias ")]),v,(0,n._)("div",null,[(0,n.Wm)(l,{class:"q-ml-none q-mr-xs",icon:"add","no-caps":"",color:"primary",onClick:a[1]||(a[1]=e=>V())},{default:(0,n.w5)((()=>[(0,n.Uk)(" Agregar cuenta"),(0,n.Wm)(u,null,{default:(0,n.w5)((()=>[(0,n.Uk)("Agregar cuenta")])),_:1})])),_:1})]),(0,n._)("div",b,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(_.value,(e=>((0,n.wg)(),(0,n.iD)("div",{class:"col-xs-12 col-sm-6 col-md-3 q-pa-sm",key:e.id},[(0,n.Wm)(l,{flat:"",color:"secondary",padding:"24px 10px","no-caps":"",onClick:a=>V(e.id),class:"full-width btn-block"},{default:(0,n.w5)((()=>[(0,n._)("strong",f,[(0,n.Wm)(i,{name:"account_balance_wallet",size:"sm"}),(0,n.Uk)(" "+(0,o.zw)(e.name),1)]),(0,n._)("span",w,(0,o.zw)(e.bank),1),(0,n._)("span",y,(0,o.zw)(e.number),1),(0,n._)("span",g,(0,o.zw)(e.total)+" "+(0,o.zw)(e.currency),1)])),_:2},1032,["onClick"])])))),128))]),(0,n.Wm)(B,{modelValue:W.value,"onUpdate:modelValue":a[6]||(a[6]=e=>W.value=e),persistent:"","transition-show":"scale","transition-hide":"scale"},{default:(0,n.w5)((()=>[(0,n.Wm)(T,{class:"modal-sm"},{default:(0,n.w5)((()=>[(0,n.Wm)(s,{class:"q-pa-md"},{default:(0,n.w5)((()=>[(0,n.Wm)(i,{name:"people",size:"md"}),(0,n.Wm)(c,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(C.value.id?"Editar":"Nueva")+" cuenta bancaria ",1)])),_:1}),(0,n.wy)((0,n.Wm)(l,{flat:"",round:"",dense:"",icon:"close"},null,512),[[D]])])),_:1}),(0,n.Wm)(x,{onSubmit:z,ref:"myForm"},{default:(0,n.w5)((()=>[(0,n.Wm)(Q,{class:"q-col-gutter-sm"},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{filled:"",modelValue:C.value.bank,"onUpdate:modelValue":a[2]||(a[2]=e=>C.value.bank=e),placeholder:C.value.bank?"":"Nombre del Banco","use-input":"","use-chips":"","input-debounce":500,onNewValue:U,options:q.value,onFilter:S,"lazy-rules":"",rules:[e=>!!e||"Seleccione a una persona"]},null,8,["modelValue","placeholder","options","rules"]),(0,n.Wm)(k,{modelValue:C.value.number,"onUpdate:modelValue":a[3]||(a[3]=e=>C.value.number=e),label:"Número de cuenta",filled:"",rules:[e=>!!e||"El campo es requerido"]},null,8,["modelValue","rules"]),(0,n.Wm)(d,{modelValue:C.value.currency,"onUpdate:modelValue":a[4]||(a[4]=e=>C.value.currency=e),label:"Moneda",filled:"","emit-value":"",options:h,rules:[e=>!!e||"El campo es requerido"]},null,8,["modelValue","rules"])])),_:1}),(0,n.Wm)(A,{align:"right"},{default:(0,n.w5)((()=>[(0,n.wy)((0,n.Wm)(l,{label:"Cancelar",icon:"cancel"},null,512),[[D]]),C.value.id?(0,n.wy)(((0,n.wg)(),(0,n.j4)(l,{key:0,label:"Eliminar",icon:"delete",color:"negative",onClick:a[5]||(a[5]=e=>(0,t.SU)(r.w)(Z,`accounts/${C.value.id}`))},null,512)),[[D]]):(0,n.kq)("",!0),(0,n.Wm)(l,{type:"submit",label:C.value.id?"Actualizar":"Guardar",icon:"check",color:"primary"},null,8,["label"])])),_:1})])),_:1},512)])),_:1})])),_:1},8,["modelValue"])])}}});var k=l(2165),_=l(5363),q=l(4554),C=l(6778),W=l(151),Q=l(9570),Z=l(3747),z=l(8689),V=l(5589),U=l(4689),S=l(2448),A=l(9367),x=l(677),T=l(7518),B=l.n(T);const D=h,O=D;B()(h,"components",{QBtn:k.Z,QTooltip:_.Z,QIcon:q.Z,QDialog:C.Z,QCard:W.Z,QToolbar:Q.Z,QToolbarTitle:Z.Z,QForm:z.Z,QCardSection:V.Z,QInput:U.Z,QSelect:S.Z,QCardActions:A.Z}),B()(h,"directives",{ClosePopup:x.Z})}}]);