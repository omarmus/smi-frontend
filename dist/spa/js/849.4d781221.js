"use strict";(globalThis["webpackChunksmi_frontend"]=globalThis["webpackChunksmi_frontend"]||[]).push([[849],{1849:(e,s,t)=>{t.r(s),t.d(s,{default:()=>H});var a=t(3673),o=t(2323),n=t(1959),l=t(8339),r=t(925),c=t(2993),i=t(4626),u=t(185),d=t(8719),p=t(9236),m=function(e,s,t,a){function o(e){return e instanceof t?e:new t((function(s){s(e)}))}return new(t||(t=Promise))((function(t,n){function l(e){try{c(a.next(e))}catch(s){n(s)}}function r(e){try{c(a["throw"](e))}catch(s){n(s)}}function c(e){e.done?t(e.value):o(e.value).then(l,r)}c((a=a.apply(e,s||[])).next())}))};const v={key:0,class:"container"},b={class:"treasury-title"},y={key:0,class:"text-warning"},g={class:"row q-col-gutter-md"},h={class:"col-xs-12 col-sm-6 col-md-3 card-button"},f=(0,a._)("strong",{class:"q-pb-sm"},"Ingresos",-1),_={class:"btn-block-detail"},k=(0,a._)("strong",null,"Total:",-1),w={class:"text-primary"},$={class:"col-xs-12 col-sm-6 col-md-3 card-button"},C=(0,a._)("strong",{class:"q-pb-sm"},"Gastos",-1),x={class:"btn-block-detail"},I=(0,a._)("strong",null,"Total:",-1),S={class:"text-primary"},q={class:"col-xs-12 col-sm-6 col-md-3 card-button"},E=(0,a._)("strong",{class:"q-pb-sm"},"Transacciones",-1),D=(0,a._)("span",{class:"btn-block-detail"},[(0,a._)("strong",null,"Bancarias")],-1),O={key:0,class:"col-xs-12 col-sm-6 col-md-3 card-button"},A=(0,a._)("strong",{class:"q-pb-sm"},"Informe mensual",-1),T=(0,a._)("span",{class:"btn-block-detail"},[(0,a._)("strong",null,"Ingresos y gastos")],-1),W={class:"text-right q-pt-md q-gutter-xs"},N=(0,a.aZ)({__name:"EntryExpense",setup(e){var s,t,N;const R=(0,p.o)(),U=(0,n.iH)(),F=(0,n.iH)(0),z=(0,n.iH)(0),L=(0,l.yj)(),H=(0,l.tv)(),{entryId:V,expenseId:j}=L.params,Z=(0,n.iH)([d.j.ADMINISTRATOR_ASSOCIATION].includes(null===(N=null===(t=null===(s=null===R||void 0===R?void 0:R.state)||void 0===s?void 0:s.user)||void 0===t?void 0:t.role)||void 0===N?void 0:N.slug)),B=()=>m(this,void 0,void 0,(function*(){U.value=yield c.http.get(`entries/${parseInt(V)}`)})),G=()=>m(this,void 0,void 0,(function*(){const e=yield c.http.get(`entriesdetails?id_entry=${U.value.id}`);F.value=e.rows.reduce(((e,s)=>e+Number(s.value)),0).toFixed(2)})),M=()=>m(this,void 0,void 0,(function*(){const e=yield c.http.get(`expensesdetails?id_expense=${j}`);z.value=e.rows.reduce(((e,s)=>e+Number(s.value)),0).toFixed(2)})),Q=()=>{if(0!==Number.parseFloat(F.value)&&0!==Number.parseFloat(z.value)||Z.value){if("ACTIVE"===U.value.state){let e=`Va a <strong>cerrar</strong> el mes de <strong>${r.e7[U.value.month-1]}</strong> este proceso es irreversible, revise los datos antes de continuar porque ya no podrá modificarlos.`;0!==Number.parseFloat(F.value)&&0!==Number.parseFloat(z.value)||(e+='<br><br><strong class="text-red">VA CERRAR EL MES CON CERO DATOS. ¿Está seguro?</strong>'),(0,u.Confirm)(e,(()=>m(this,void 0,void 0,(function*(){return yield c.http.put(`entries/close/${V}/${j}`),H.push(`/treasury/report/${V}/${j}`)}))),null,"Advertencia","Cerrar mes")}}else i.message.warning("Debe llenar los ingresos y los gastos")};return(0,a.wF)((()=>m(this,void 0,void 0,(function*(){yield B(),yield G(),yield M()})))),(e,s)=>{const t=(0,a.up)("q-btn"),l=(0,a.up)("q-icon");return U.value?((0,a.wg)(),(0,a.iD)("div",v,[(0,a._)("h2",b,[(0,a.Wm)(t,{icon:"arrow_back",round:"",flat:"",onClick:s[0]||(s[0]=s=>e.$router.push("/treasury"))}),(0,a.Uk)(" Ingresos y Gastos de "+(0,o.zw)((0,n.SU)(r.e7)[U.value.month-1])+" "+(0,o.zw)(U.value.year)+" ",1),"CLOSED"===U.value.state?((0,a.wg)(),(0,a.iD)("span",y,"CERRADO")):(0,a.kq)("",!0)]),(0,a._)("div",g,[(0,a._)("div",h,[(0,a.Wm)(t,{flat:"",color:"secondary",padding:"lg","no-caps":"",onClick:s[1]||(s[1]=s=>e.$router.push(`/treasury/week/${e.$route.params.entryId}/${e.$route.params.expenseId}`)),class:"full-width btn-block"},{default:(0,a.w5)((()=>{var s;return[f,(0,a._)("span",_,[k,(0,a.Uk)(),(0,a._)("span",w,(0,o.zw)(F.value)+" "+(0,o.zw)(null===(s=e.$store.state.user)||void 0===s?void 0:s.user.company.money),1)]),(0,a.Wm)(l,{name:"attach_money"})]})),_:1})]),(0,a._)("div",$,[(0,a.Wm)(t,{flat:"",color:"secondary",padding:"lg","no-caps":"",onClick:s[2]||(s[2]=s=>e.$router.push(`/treasury/expense/${e.$route.params.expenseId}`)),class:"full-width btn-block"},{default:(0,a.w5)((()=>{var s;return[C,(0,a._)("span",x,[I,(0,a.Uk)(),(0,a._)("span",S,(0,o.zw)(z.value)+" "+(0,o.zw)(null===(s=e.$store.state.user)||void 0===s?void 0:s.user.company.money),1)]),(0,a.Wm)(l,{name:"payments"})]})),_:1})]),(0,a._)("div",q,[(0,a.Wm)(t,{flat:"",color:"secondary",padding:"lg","no-caps":"",onClick:s[3]||(s[3]=s=>e.$router.push(`/treasury/transactions/${(0,n.SU)(V)}/${(0,n.SU)(j)}`)),class:"full-width btn-block"},{default:(0,a.w5)((()=>[E,D,(0,a.Wm)(l,{name:"point_of_sale"})])),_:1})]),"CLOSED"===U.value.state?((0,a.wg)(),(0,a.iD)("div",O,[(0,a.Wm)(t,{flat:"",color:"secondary",padding:"lg","no-caps":"",onClick:s[4]||(s[4]=s=>e.$router.push(`/treasury/report/${(0,n.SU)(V)}/${(0,n.SU)(j)}`)),class:"full-width btn-block"},{default:(0,a.w5)((()=>[A,T,(0,a.Wm)(l,{name:"today"})])),_:1})])):(0,a.kq)("",!0)]),(0,a._)("div",W,[(0,a.Wm)(t,{label:"Cambiar mes","no-caps":"",icon:"calendar_month",class:"btn-close-month",onClick:s[5]||(s[5]=s=>e.$router.push("/treasury/months"))}),"CLOSED"!==U.value.state?((0,a.wg)(),(0,a.j4)(t,{key:0,label:"CLOSED"===U.value.state?"Ver informe mensual":"Cerrar el mes","no-caps":"",color:"primary",icon:"CLOSED"===U.value.state?"print":"check",class:"btn-close-month",onClick:Q},null,8,["label","icon"])):(0,a.kq)("",!0)])])):(0,a.kq)("",!0)}}});var R=t(2165),U=t(4554),F=t(7518),z=t.n(F);const L=N,H=L;z()(N,"components",{QBtn:R.Z,QIcon:U.Z})}}]);