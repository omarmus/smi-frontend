"use strict";(globalThis["webpackChunksmi_frontend"]=globalThis["webpackChunksmi_frontend"]||[]).push([[412],{982:(l,e,o)=>{o.r(e),o.d(e,{default:()=>X});var a=o(3673),t=o(2323),n=o(1959),i=o(2993),s=o(4626),u=o(5198),d=o(6872),r=o(8468),c=o(5751),m=o(8719),p=o(9236),v=function(l,e,o,a){function t(l){return l instanceof o?l:new o((function(e){e(l)}))}return new(o||(o=Promise))((function(o,n){function i(l){try{u(a.next(l))}catch(e){n(e)}}function s(l){try{u(a["throw"](l))}catch(e){n(e)}}function u(l){l.done?o(l.value):t(l.value).then(i,s)}u((a=a.apply(l,e||[])).next())}))};const w={class:"container"},b={class:"treasury-title"},f={class:"row q-col-gutter-md"},I={class:"col-xs-12 col-md-12"},C={key:0,class:"col-xs-12 col-md-6"},g={key:1,class:"col-xs-12 col-md-6"},k={key:2,class:"col-xs-12 col-md-12"},U={class:"col-xs-12 col-md-12"},h={class:"col-xs-12 col-md-6"},y={class:"col-xs-12 col-md-6"},V={class:"col-xs-12 col-md-12"},S={class:"row"},_=(0,a._)("div",{class:"col-xs-6 col-md-6"},[(0,a._)("h3",{class:"title-contacts"},"Contactos:")],-1),N={class:"col-xs-6 col-md-6 text-right"},O={key:3,class:"col-xs-12 col-md-12"},x={class:"col-xs-12 col-md-6"},A={class:"col-xs-12 col-md-5"},q={class:"col-xs-12 col-md-1"},W={class:"col-xs-12 text-right q-gutter-sm"},T={key:0,class:"q-ma-none q-pa-none"},R=(0,a.aZ)({__name:"Church",setup(l){const e=(0,p.o)(),o="companies",R=[m.j.SUPERADMINISTRATOR].includes(e.state.user.role.slug),E=[m.j.ADMINISTRATOR_UNION,m.j.ADMINISTRATOR_ASSOCIATION].includes(e.state.user.role.slug),D=[{label:"Acciones",align:"center",sortable:!1},{name:"name",label:"Nombre",align:"left",sortable:!0},{name:"address",label:"Dirección",align:"left",sortable:!0},{name:"info",label:"Contacto(s)",align:"left",sortable:!0},{name:"type",label:"Tipo",sortable:!0},{name:"state",label:"Estado",sortable:!0}],Z=R?[{value:"GENERAL",label:"GENERAL"},{value:"UNION",label:"UNION"},{value:"DIVISION",label:"DIVISION"},{value:"ASSOCIATION",label:"ASOCIACION"},{value:"MISSION",label:"MISION"},{value:"CHURCH",label:"IGLESIA"},{value:"GROUP",label:"GRUPO"}]:[{value:"MISSION",label:"MISION"},{value:"CHURCH",label:"IGLESIA"},{value:"GROUP",label:"GRUPO"}],G=[{label:"Nombre",name:"name",type:"input"},{label:"Tipo",name:"type",type:"select",options:Z},{label:"Estado",name:"state",type:"select",options:[{label:"ACTIVO",value:"ACTIVE"},{label:"INACTIVO",value:"INACTIVE"}]}],H={GENERAL:{color:"positive",textColor:"white",label:"GENERAL"},UNION:{color:"info",textColor:"white",label:"UNION"},ASSOCIATION:{color:"warning",textColor:"white",label:"ASOCIACION"},DIVISION:{color:"positive",textColor:"white",label:"DIVISION"},MISSION:{color:"info",textColor:"white",label:"MISION"},CHURCH:{color:"positive",textColor:"white",label:"IGLESIA"},GROUP:{color:"warning",textColor:"white",label:"GRUPO"},ACTIVE:{color:"positive",textColor:"white",label:"ACTIVO"},INACTIVE:{color:"warning",textColor:"white",label:"INACTIVO"}},$={name:[r.Z.required],description:[],type:[r.Z.required],phones:[],address:[],web:[r.Z.url],email:[r.Z.email]},Q=(0,n.iH)(),M=(0,n.iH)(),P=()=>v(this,void 0,void 0,(function*(){const l=yield i.http.get("companies");M.value=l.rows})),z=(l,e)=>v(this,void 0,void 0,(function*(){e?(Q.value=yield i.http.get(`${o}/${e}`),Q.value.info||(Q.value.info={contacts:[{id:(0,c.k$)(),name:"",phone:""}]})):Q.value={type:"CHURCH",info:{contacts:[{id:(0,c.k$)(),name:"",phone:""}]}},l()})),j=()=>{Q.value.info.contacts.push({id:(0,c.k$)(),name:"",phone:""})},L=l=>{Q.value.info.contacts=Q.value.info.contacts.filter((e=>e.id!==l))},F=l=>v(this,void 0,void 0,(function*(){var e;(null===(e=Q.value)||void 0===e?void 0:e.id)?(yield i.http.put(`${o}/${Q.value.id}`,Q.value),s.message.success("¡Registro actualizado!")):(yield i.http.post(o,Q.value),s.message.success("¡Registro creado exitósamente!")),l.update(),l.close()}));return(0,a.wF)((()=>v(this,void 0,void 0,(function*(){yield P()})))),(l,e)=>{const i=(0,a.up)("q-btn"),s=(0,a.up)("q-tooltip"),r=(0,a.up)("q-icon"),c=(0,a.up)("q-toolbar-title"),m=(0,a.up)("q-toolbar"),p=(0,a.up)("q-input"),v=(0,a.up)("q-select"),P=(0,a.up)("q-form"),K=(0,a.up)("q-card-section"),Y=(0,a.up)("q-card"),B=(0,a.up)("q-toggle"),J=(0,a.up)("q-td"),X=(0,a.up)("q-chip"),ll=(0,a.up)("q-tr");return(0,a.wg)(),(0,a.iD)("div",w,[(0,a._)("h2",b,[(0,a.Wm)(i,{icon:"arrow_back",round:"",flat:"",onClick:e[0]||(e[0]=e=>l.$router.push("/secretary"))}),(0,a.Uk)(" Iglesias ")]),(0,a.Wm)(u.Z,{url:o,filters:G,columns:D,order:"id"},{buttons:(0,a.w5)((e=>{var o,t;return[(null===(t=null===(o=l.$store.state.user)||void 0===o?void 0:o.permissions)||void 0===t?void 0:t.includes("company:create"))?((0,a.wg)(),(0,a.j4)(i,{key:0,class:"q-ml-none q-mr-xs",icon:"add","no-caps":"",color:"primary",onClick:l=>z(e.open)},{default:(0,a.w5)((()=>[(0,a.Uk)(" Agregar "),(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Agregar registro")])),_:1})])),_:2},1032,["onClick"])):(0,a.kq)("",!0)]})),form:(0,a.w5)((l=>[(0,a.Wm)(Y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"q-pa-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{name:"home_work",size:"md"}),(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,t.zw)(Q.value.id?"Editar":"Agregar")+" registro ",1)])),_:1}),(0,a.Wm)(i,{flat:"",round:"",dense:"",icon:"close",onClick:l.close},null,8,["onClick"])])),_:2},1024),(0,a.Wm)(K,null,{default:(0,a.w5)((()=>[(0,a.Wm)(P,{onSubmit:e=>F(l)},{default:(0,a.w5)((()=>{var o,t;return[(0,a._)("div",f,[(0,a._)("div",I,[(0,a.Wm)(p,{label:"Nombre",filled:"",modelValue:Q.value.name,"onUpdate:modelValue":e[1]||(e[1]=l=>Q.value.name=l),rules:$.name,disable:!((0,n.SU)(E)||(0,n.SU)(R)),autofocus:""},null,8,["modelValue","rules","disable"])]),(0,n.SU)(E)||(0,n.SU)(R)?((0,a.wg)(),(0,a.iD)("div",C,[(0,a.Wm)(v,{label:"Tipo",filled:"",modelValue:Q.value.type,"onUpdate:modelValue":e[2]||(e[2]=l=>Q.value.type=l),options:(0,n.SU)(Z),rules:$.type,"emit-value":"","map-options":""},null,8,["modelValue","options","rules"])])):(0,a.kq)("",!0),(0,n.SU)(E)||(0,n.SU)(R)?((0,a.wg)(),(0,a.iD)("div",g,[(0,a.Wm)(v,{label:"Misión",filled:"",modelValue:Q.value.idCompany,"onUpdate:modelValue":e[3]||(e[3]=l=>Q.value.idCompany=l),options:M.value.filter((l=>["MISSION"].includes(l.type))),rules:$.type,disable:!["CHURCH","GROUP"].includes(Q.value.type),"option-value":"id","option-label":"name","emit-value":"","map-options":""},null,8,["modelValue","options","rules","disable"])])):(0,a.kq)("",!0),["CHURCH","GROUP"].includes(Q.value.type)?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",k,[(0,a.Wm)(p,{label:"Descripción",filled:"",modelValue:Q.value.description,"onUpdate:modelValue":e[4]||(e[4]=l=>Q.value.description=l),rules:$.description},null,8,["modelValue","rules"])])),(0,a._)("div",U,[(0,a.Wm)(p,{label:"Dirección",filled:"",modelValue:Q.value.address,"onUpdate:modelValue":e[5]||(e[5]=l=>Q.value.address=l),rules:$.address},null,8,["modelValue","rules"])]),(0,a._)("div",h,[(0,a.Wm)(p,{label:"Teléfonos",filled:"",modelValue:Q.value.phones,"onUpdate:modelValue":e[6]||(e[6]=l=>Q.value.phones=l),rules:$.phones},null,8,["modelValue","rules"])]),(0,a._)("div",y,[(0,a.Wm)(p,{label:"Correo electrónico de contacto",filled:"",modelValue:Q.value.email,"onUpdate:modelValue":e[7]||(e[7]=l=>Q.value.email=l),rules:$.email},null,8,["modelValue","rules"])]),(0,a._)("div",V,[(0,a._)("div",S,[_,(0,a._)("div",N,[(0,a.Wm)(i,{class:"q-mt-md",rounded:"",label:"Agregar contacto",size:"sm",icon:"add",color:"positive","no-caps":"",onClick:j})])])]),(null===(t=null===(o=Q.value)||void 0===o?void 0:o.info)||void 0===t?void 0:t.contacts)?((0,a.wg)(),(0,a.iD)("div",O,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(Q.value.info.contacts,(l=>((0,a.wg)(),(0,a.iD)("div",{class:"row q-col-gutter-md",key:l.id},[(0,a._)("div",x,[(0,a.Wm)(p,{dense:"",label:"Nombre",filled:"",modelValue:l.name,"onUpdate:modelValue":e=>l.name=e,rules:$.name},null,8,["modelValue","onUpdate:modelValue","rules"])]),(0,a._)("div",A,[(0,a.Wm)(p,{dense:"",label:"Teléfono(s)",filled:"",modelValue:l.phone,"onUpdate:modelValue":e=>l.phone=e,rules:$.phone},null,8,["modelValue","onUpdate:modelValue","rules"])]),(0,a._)("div",q,[(0,a.Wm)(i,{class:"q-mt-xs",round:"",icon:"delete",color:"negative",size:"sm",onClick:e=>L(l.id)},null,8,["onClick"])])])))),128))])):(0,a.kq)("",!0),(0,a._)("div",W,[(0,a.Wm)(i,{icon:"close",label:"Cancelar",onClick:l.close},null,8,["onClick"]),(0,a.Wm)(i,{icon:"check",color:"secondary",label:"Guardar",type:"submit"})])])]})),_:2},1032,["onSubmit"])])),_:2},1024)])),_:2},1024)])),row:(0,a.w5)((e=>[(0,a.Wm)(ll,null,{default:(0,a.w5)((()=>[(0,a.Wm)(J,null,{default:(0,a.w5)((()=>{var t,u,r,c;return[(null===(u=null===(t=l.$store.state.user)||void 0===t?void 0:t.permissions)||void 0===u?void 0:u.includes("company:update"))?((0,a.wg)(),(0,a.j4)(i,{key:0,flat:"",round:"",onClick:l=>z(e.open,e.row.id),icon:"edit"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Editar registro")])),_:1})])),_:2},1032,["onClick"])):(0,a.kq)("",!0),(null===(c=null===(r=l.$store.state.user)||void 0===r?void 0:r.permissions)||void 0===c?void 0:c.includes("company:delete"))?((0,a.wg)(),(0,a.j4)(i,{key:1,color:"negative",flat:"",round:"",onClick:l=>(0,n.SU)(d.w)(e.update,`${o}/${e.row.id}`),icon:"delete"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Eliminar registro")])),_:1})])),_:2},1032,["onClick"])):(0,a.kq)("",!0),(0,n.SU)(E)||(0,n.SU)(R)?((0,a.wg)(),(0,a.j4)(B,{key:2,modelValue:e.row.state,"onUpdate:modelValue":l=>e.row.state=l,color:"primary","false-value":"INACTIVE","true-value":"ACTIVE",onClick:l=>(0,n.SU)(d.$)(e.update,e.row,`${o}/${e.row.id}`)},null,8,["modelValue","onUpdate:modelValue","onClick"])):(0,a.kq)("",!0)]})),_:2},1024),(0,a.Wm)(J,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,t.zw)(e.row.name),1)])),_:2},1024),(0,a.Wm)(J,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,t.zw)(e.row.address),1)])),_:2},1024),(0,a.Wm)(J,null,{default:(0,a.w5)((()=>{var l;return[(null===(l=e.row.info)||void 0===l?void 0:l.contacts)?((0,a.wg)(),(0,a.iD)("ul",T,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.row.info.contacts,(l=>((0,a.wg)(),(0,a.iD)("li",{key:l.id},[(0,a.Uk)((0,t.zw)(l.name)+" ",1),(0,a._)("em",null,(0,t.zw)(l.phone),1)])))),128))])):(0,a.kq)("",!0)]})),_:2},1024),(0,a.Wm)(J,{class:"text-right"},{default:(0,a.w5)((()=>[(0,a.Wm)(X,{square:"",dense:"",color:H[e.row.type].color,"text-color":H[e.row.type].textColor,label:H[e.row.type].label},null,8,["color","text-color","label"])])),_:2},1024),(0,a.Wm)(J,{class:"text-right"},{default:(0,a.w5)((()=>[(0,a.Wm)(X,{square:"",dense:"",color:H[e.row.state].color,"text-color":H[e.row.state].textColor,label:H[e.row.state].label},null,8,["color","text-color","label"])])),_:2},1024)])),_:2},1024)])),_:1})])}}});var E=o(2165),D=o(5363),Z=o(151),G=o(9570),H=o(4554),$=o(3747),Q=o(5589),M=o(8689),P=o(4689),z=o(2448),j=o(8186),L=o(3884),F=o(8886),K=o(7030),Y=o(7518),B=o.n(Y);const J=R,X=J;B()(R,"components",{QBtn:E.Z,QTooltip:D.Z,QCard:Z.Z,QToolbar:G.Z,QIcon:H.Z,QToolbarTitle:$.Z,QCardSection:Q.Z,QForm:M.Z,QInput:P.Z,QSelect:z.Z,QTr:j.Z,QTd:L.Z,QToggle:F.Z,QChip:K.Z})}}]);