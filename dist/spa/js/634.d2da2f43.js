"use strict";(globalThis["webpackChunksmi_frontend"]=globalThis["webpackChunksmi_frontend"]||[]).push([[634],{8634:(e,a,l)=>{l.r(a),l.d(a,{default:()=>Q});var o=l(3673),t=l(2323),n=l(1959),s=l(8339),i=l(9236),r=l(2993),u=l(4626),c=l(4781),d=l(185),m=l(925),p=l(8468),v=function(e,a,l,o){function t(e){return e instanceof l?e:new l((function(a){a(e)}))}return new(l||(l=Promise))((function(l,n){function s(e){try{r(o.next(e))}catch(a){n(a)}}function i(e){try{r(o["throw"](e))}catch(a){n(a)}}function r(e){e.done?l(e.value):t(e.value).then(s,i)}r((o=o.apply(e,a||[])).next())}))};const g={class:"container"},f={class:"treasury-title"},w={class:"text-warning"},h=(0,o._)("div",{class:"alert alert-info"},[(0,o.Uk)("Para "),(0,o._)("strong",null,"empezar"),(0,o.Uk)(" a registrar la información de tesorería primero necesita seleccionar el "),(0,o._)("strong",null,"MES"),(0,o.Uk)(" en el que empezará a contabilizar los registros de tesorería en el sistema, es decir el "),(0,o._)("strong",null,"siguiente mes"),(0,o.Uk)(" del último libro de tesorería que llenó.")],-1),_={class:"q-pb-md"},b={class:"row q-col-gutter-x-sm"},y={class:"col-xs-12 col-md-8"},k={class:"col-xs-12 col-md-4"},U={class:"alert alert-info"},x=(0,o._)("strong",null,"llenar los montos de cada departamento",-1),q=(0,o._)("div",{class:"alert alert-info"},[(0,o._)("strong",null,"Importante.-"),(0,o.Uk)(" Use el punto "),(0,o._)("strong",null,"."),(0,o.Uk)(" como separador decimal para los centavos en todo el sistema. "),(0,o._)("em",null,"Ejemplo: 132.5")],-1),C={class:"text-right"},V={class:"row flow-items q-col-gutter-x-lg q-pt-md"},D={class:"row q-pb-xs"},S={class:"col-8 q-pb-lg"},z={class:"col-xs-4 col-sm-4"},I={class:"text-right q-pt-lg"},F=(0,o.aZ)({__name:"Initial",setup(e){var a,l;const F=(0,s.tv)(),H=(0,i.o)(),Z=(0,n.iH)([]),T=(0,n.iH)(),W=(0,n.iH)(),$=(0,n.iH)((new Date).getFullYear()),A=null===(l=null===(a=H.state.user)||void 0===a?void 0:a.user)||void 0===l?void 0:l.company.id,E=()=>v(this,void 0,void 0,(function*(){const e=yield r.http.get("departments?order=id&type=LOCAL");Z.value=e.rows})),Q=()=>v(this,void 0,void 0,(function*(){const e=yield r.http.get(`flows?id_company=${A}&type=INITIAL`);e.count?(Z.value=e.rows.map((e=>({id:e.department.id,name:e.department.name,total:e.total}))),T.value=!0,W.value=e.rows[0].month):yield E()})),Y=()=>0===Z.value.reduce(((e,a)=>e+(a.total||0)),0)?u.message.warning("Debe llenar por lo menos un monto de algún departamento para continuar"):Z.value.reduce(((e,a)=>e&&(!a.total||(0,p.K)(a.total))),!0)?void(0,d.Confirm)("<p>Revise que los datos ingresados sean correctos, solo podrá configurar esta información por única vez.<p> ¿Deséa continuar?",(()=>v(this,void 0,void 0,(function*(){return yield r.http.post("flows/initial",{id_company:A,departments:Z.value,month:W.value,year:$.value}),u.message.success("Configuración guardada correctamente"),c.storage.set("initial",!1),H.commit("global/setInitial",!1),F.push("/treasury")}))),null,"Advertencia","Si, continuar"):u.message.warning("- El formato del monto no es válido, use el punto decimal como separador de decimales,<br>- Tampoco puede usar las comas como separador de miles"),j=(0,o.Fl)((()=>{let e=0;return Z.value.forEach((a=>{e+=Number(a.total||0)})),e.toFixed(2)})),L=(0,o.Fl)((()=>W.value>1?m.e7[W.value-2].toUpperCase():m.e7[11].toUpperCase()));return(0,o.wF)((()=>v(this,void 0,void 0,(function*(){yield Q()})))),(e,a)=>{var l,s;const i=(0,o.up)("q-btn"),r=(0,o.up)("q-select"),u=(0,o.up)("q-chip"),c=(0,o.up)("q-input");return(0,o.wg)(),(0,o.iD)("div",g,[(0,o._)("h2",f,[(0,o.Wm)(i,{icon:"arrow_back",round:"",flat:"",onClick:a[0]||(a[0]=a=>e.$router.push("/"))}),(0,o.Uk)(" Configuración Caja local - "),(0,o._)("span",w,(0,t.zw)(null===(s=null===(l=e.$store.state.user)||void 0===l?void 0:l.user)||void 0===s?void 0:s.company.name),1)]),h,(0,o._)("div",_,[(0,o._)("div",b,[(0,o._)("div",y,[(0,o.Wm)(r,{modelValue:W.value,"onUpdate:modelValue":a[1]||(a[1]=e=>W.value=e),options:(0,n.SU)(m.e7).map(((e,a)=>({value:a+1,label:e.toUpperCase()}))),label:"Seleccione el mes","emit-value":"","map-options":"",filled:"",disable:T.value,rules:[e=>!!e||"Debe seleccionar el mes para continuar"]},null,8,["modelValue","options","disable","rules"])]),(0,o._)("div",k,[(0,o.Wm)(r,{modelValue:$.value,"onUpdate:modelValue":a[2]||(a[2]=e=>$.value=e),options:(0,n.SU)(m.V4)(0,(new Date).getFullYear()-1),label:"Seleccione el año","emit-value":"","map-options":"",filled:"",disable:T.value,rules:[e=>!!e||"Debe seleccionar el año para continuar"]},null,8,["modelValue","options","disable","rules"])])])]),W.value?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o._)("div",U,[(0,o.Uk)("Ahora debe "),x,(0,o.Uk)(" de su iglesia local que tiene como saldo acumulado hasta "),(0,o._)("strong",null,(0,t.zw)((0,n.SU)(L)),1)]),q,(0,o._)("div",C,[(0,o.Wm)(u,{square:"",color:"warning","text-color":"white"},{default:(0,o.w5)((()=>{var a;return[(0,o._)("strong",null,"Total: "+(0,t.zw)((0,n.SU)(j))+" "+(0,t.zw)(null===(a=e.$store.state.user)||void 0===a?void 0:a.user.company.money),1)]})),_:1})]),(0,o._)("div",V,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(Z.value,(a=>{var l;return(0,o.wg)(),(0,o.iD)("div",{class:"col-xs-12 col-sm-6",key:a.id},[(0,o._)("div",D,[(0,o._)("div",S,(0,t.zw)(a.name),1),(0,o._)("div",z,[(0,o.Wm)(c,{standout:"",class:"text-right",dense:"",placeholder:"0.0",suffix:null===(l=e.$store.state.user)||void 0===l?void 0:l.user.company.money,modelValue:a.total,"onUpdate:modelValue":e=>a.total=e,disable:T.value,rules:[(0,n.SU)(p.Z).decimal]},null,8,["suffix","modelValue","onUpdate:modelValue","disable","rules"])])])])})),128))]),(0,o._)("div",I,[T.value?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(i,{key:0,label:"Guardar configuración inicial","no-caps":"",color:"primary",icon:"check",padding:"10px 20px",class:"btn-close-month",onClick:Y}))])],64)):(0,o.kq)("",!0)])}}});var H=l(2165),Z=l(2448),T=l(7030),W=l(4689),$=l(7518),A=l.n($);const E=F,Q=E;A()(F,"components",{QBtn:H.Z,QSelect:Z.Z,QChip:T.Z,QInput:W.Z})}}]);