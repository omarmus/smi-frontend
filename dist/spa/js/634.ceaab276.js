"use strict";(self["webpackChunksmi_frontend"]=self["webpackChunksmi_frontend"]||[]).push([[634],{925:(e,t,o)=>{o.d(t,{e7:()=>a,KS:()=>l,WU:()=>n,Fv:()=>r});const a=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],l=(e,t)=>{const o=new Date(e,t,0).getDate(),a=new Date(e,t-1,1),l=[];for(let n=6-a.getDay(),r=1;n<o;n+=7,r++)l.push({day:n+1,label:`Sábado ${n+1}`,week:r,total:0});return l},n=e=>{if(!e)return null;const t=new Date(e);return[t.getUTCDate(),t.getUTCMonth()+1,t.getUTCFullYear()].join("/")},r=e=>e?[e.split("/")[2],e.split("/")[1],e.split("/")[0]].join("-"):null},8468:(e,t,o)=>{o.d(t,{Z:()=>a,K:()=>l});const a={email:e=>{const t=/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/;return t.test(String(e).toLowerCase())||!e||"El correo no es válido."},url:e=>/[-a-zA-Z0-9@:%_+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_+.~#?&//=]*)?/.test(e)||!e||"Introduzca una URL válida",date:e=>/^((0?[1-9]|[12][0-9]|3[01])[- /.](0?[1-9]|1[012])[- /.](19|20)?[0-9]{2})*$/.test(e)||!e||"Introduzca una fecha válida",password:e=>e.length>=6||!e||"Debe tener al menos 6 carácteres.",required:e=>!!e||"El campo es requerido.",phone:e=>{const t=/^[0-9]/;return t.test(String(e).toLowerCase())&&8===e.length||!e||"Introduzca un numero de celular válido."},alphabet:e=>{const t=/^[a-zñÑáéíóú]/;return t.test(String(e).toLowerCase())||!e||"Solo se permiten letras."},number:e=>{const t=/^\d+$/g;return t.test(String(e))||!e||"Solo se permiten numeros enteros."},decimal:e=>{const t=/^\d*\.?\d*$/g;return t.test(String(e))||!e||"Use el punto (.) para los decimales."}};function l(e){return/^\d*\.?\d*$/.test(e)}},8634:(e,t,o)=>{o.r(t),o.d(t,{default:()=>H});var a=o(3673),l=o(2323),n=o(1959),r=o(9582),s=o(9236),i=o(2993),u=o(4626),c=o(4781),d=o(185),m=o(925),p=o(8468),v=function(e,t,o,a){function l(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,n){function r(e){try{i(a.next(e))}catch(t){n(t)}}function s(e){try{i(a["throw"](e))}catch(t){n(t)}}function i(e){e.done?o(e.value):l(e.value).then(r,s)}i((a=a.apply(e,t||[])).next())}))};const g={class:"container"},w={class:"treasury-title"},f=(0,a.Uk)(" Configuración Caja local - "),h={class:"text-warning"},b=(0,a._)("div",{class:"alert alert-info"},[(0,a.Uk)("Para "),(0,a._)("strong",null,"empezar"),(0,a.Uk)(" a registrar la información de tesorería primero necesita seleccionar el "),(0,a._)("strong",null,"MES"),(0,a.Uk)(" en el que empezará a contabilizar los registros de tesorería en el sistema, es decir el "),(0,a._)("strong",null,"siguiente mes"),(0,a.Uk)(" del último libro de tesorería que llenó.")],-1),_={class:"q-pb-md"},U={class:"alert alert-info"},k=(0,a.Uk)("Ahora debe "),y=(0,a._)("strong",null,"llenar los montos de cada departamento",-1),q=(0,a.Uk)(" de su iglesia local que tiene como saldo acumulado hasta "),C=(0,a._)("div",{class:"alert alert-info"},[(0,a._)("strong",null,"Importante.-"),(0,a.Uk)(" Use el punto "),(0,a._)("strong",null,"."),(0,a.Uk)(" como separador decimal para los centavos en todo el sistema. "),(0,a._)("em",null,"Ejemplo: 132.5")],-1),S={class:"text-right"},z={class:"row flow-items q-col-gutter-x-lg q-pt-md"},x={class:"row q-pb-xs"},D={class:"col-8 q-pb-lg"},I={class:"col-xs-4 col-sm-4"},Z={class:"text-right q-pt-lg"},$=(0,a.aZ)({setup(e){var t,o;const $=(0,r.tv)(),A=(0,s.useStore)(),E=(0,n.iH)([]),F=(0,n.iH)(),L=(0,n.iH)(),V=null===(o=null===(t=A.state.user)||void 0===t?void 0:t.user)||void 0===o?void 0:o.company.id,T=()=>v(this,void 0,void 0,(function*(){const e=yield i.http.get("departments?order=id&type=LOCAL");E.value=e.rows})),j=()=>v(this,void 0,void 0,(function*(){const e=yield i.http.get(`flows?id_company=${V}&type=INITIAL`);e.count?(E.value=e.rows.map((e=>({id:e.department.id,name:e.department.name,total:e.total}))),F.value=!0,L.value=e.rows[0].month):yield T()})),H=()=>0===E.value.reduce(((e,t)=>e+(t.total||0)),0)?u.message.warning("Debe llenar por lo menos un monto de algún departamento para continuar"):E.value.reduce(((e,t)=>e&&(!t.total||(0,p.K)(t.total))),!0)?void(0,d.Confirm)("<p>Revise que los datos ingresados sean correctos, solo podrá configurar esta información una única vez.<p> ¿Deséa continuar?",(()=>v(this,void 0,void 0,(function*(){return yield i.http.post("flows/initial",{id_company:V,departments:E.value,month:L.value}),u.message.success("Configuración guardada correctamente"),c.storage.set("initial",!1),A.commit("global/setInitial",!1),$.push("/treasury")}))),null,"Advertencia","Si, continuar"):u.message.warning("- El formato del monto no es válido, use el punto decimal como separador de decimales,<br>- Tampoco puede usar las comas como separador de miles"),W=(0,n.Fl)((()=>{let e=0;return E.value.forEach((t=>{e+=Number(t.total||0)})),e.toFixed(2)})),K=(0,n.Fl)((()=>L.value>1?m.e7[L.value-2].toUpperCase():m.e7[11].toUpperCase()));return(0,a.wF)((()=>v(this,void 0,void 0,(function*(){yield j()})))),(e,t)=>{var o,r;const s=(0,a.up)("q-btn"),i=(0,a.up)("q-select"),u=(0,a.up)("q-chip"),c=(0,a.up)("q-input");return(0,a.wg)(),(0,a.iD)("div",g,[(0,a._)("h2",w,[(0,a.Wm)(s,{icon:"arrow_back",round:"",flat:"",onClick:t[0]||(t[0]=t=>e.$router.push("/"))}),f,(0,a._)("span",h,(0,l.zw)(null===(r=null===(o=e.$store.state.user)||void 0===o?void 0:o.user)||void 0===r?void 0:r.company.name),1)]),b,(0,a._)("div",_,[(0,a.Wm)(i,{modelValue:L.value,"onUpdate:modelValue":t[1]||(t[1]=e=>L.value=e),options:(0,n.SU)(m.e7).map(((e,t)=>({value:t+1,label:e.toUpperCase()}))),label:"Seleccione el mes","emit-value":"","map-options":"",filled:"",disable:F.value,rules:[e=>!!e||"Debe seleccionar el mes para continuar"]},null,8,["modelValue","options","disable","rules"])]),L.value?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a._)("div",U,[k,y,q,(0,a._)("strong",null,(0,l.zw)((0,n.SU)(K)),1)]),C,(0,a._)("div",S,[(0,a.Wm)(u,{square:"",color:"warning","text-color":"white"},{default:(0,a.w5)((()=>[(0,a._)("strong",null,"Total: "+(0,l.zw)((0,n.SU)(W))+" Bs.",1)])),_:1})]),(0,a._)("div",z,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(E.value,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"col-xs-12 col-sm-6",key:e.id},[(0,a._)("div",x,[(0,a._)("div",D,(0,l.zw)(e.name),1),(0,a._)("div",I,[(0,a.Wm)(c,{standout:"",class:"text-right",dense:"",placeholder:"0.0",suffix:"Bs.",modelValue:e.total,"onUpdate:modelValue":t=>e.total=t,disable:F.value,rules:[(0,n.SU)(p.Z).decimal]},null,8,["modelValue","onUpdate:modelValue","disable","rules"])])])])))),128))]),(0,a._)("div",Z,[F.value?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(s,{key:0,label:"Guardar configuración inicial","no-caps":"",color:"primary",icon:"check",padding:"10px 20px",class:"btn-close-month",onClick:H}))])],64)):(0,a.kq)("",!0)])}}});var A=o(8240),E=o(2448),F=o(7030),L=o(4689),V=o(7518),T=o.n(V);const j=$,H=j;T()($,"components",{QBtn:A.Z,QSelect:E.Z,QChip:F.Z,QInput:L.Z})}}]);