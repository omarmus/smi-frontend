"use strict";(globalThis["webpackChunksmi_frontend"]=globalThis["webpackChunksmi_frontend"]||[]).push([[849],{1849:(e,s,t)=>{t.r(s),t.d(s,{default:()=>V});var n=t(3673),o=t(2323),a=t(1959),r=t(8339),l=t(925),i=t(2993),c=t(4626),u=t(185),d=t(8719),m=t(9236),p=function(e,s,t,n){function o(e){return e instanceof t?e:new t((function(s){s(e)}))}return new(t||(t=Promise))((function(t,a){function r(e){try{i(n.next(e))}catch(s){a(s)}}function l(e){try{i(n["throw"](e))}catch(s){a(s)}}function i(e){e.done?t(e.value):o(e.value).then(r,l)}i((n=n.apply(e,s||[])).next())}))};const v={key:0,class:"container"},g={class:"treasury-title"},b={key:0,class:"text-warning"},y={class:"row q-col-gutter-md"},h={class:"col-xs-12 col-sm-6 col-md-3 card-button"},f=(0,n._)("strong",{class:"q-pb-sm"},"Ingresos",-1),k={class:"btn-block-detail"},_=(0,n._)("strong",null,"Total:",-1),w={class:"text-primary"},$={class:"col-xs-12 col-sm-6 col-md-3 card-button"},C=(0,n._)("strong",{class:"q-pb-sm"},"Gastos",-1),x={class:"btn-block-detail"},E=(0,n._)("strong",null,"Total:",-1),I={class:"text-primary"},S={class:"col-xs-12 col-sm-6 col-md-3 card-button"},q=(0,n._)("strong",{class:"q-pb-sm"},"Transacciones",-1),D=(0,n._)("span",{class:"btn-block-detail"},[(0,n._)("strong",null,"Bancarias")],-1),O={key:0,class:"col-xs-12 col-sm-6 col-md-3 card-button"},A=(0,n._)("strong",{class:"q-pb-sm"},"Informe mensual",-1),T=(0,n._)("span",{class:"btn-block-detail"},[(0,n._)("strong",null,"Ingresos y gastos")],-1),R={class:"text-right q-pt-md q-gutter-xs"},W=(0,n.aZ)({__name:"EntryExpense",setup(e){var s,t,W;const N=(0,m.o)(),U=(0,a.iH)(),F=(0,a.iH)(0),L=(0,a.iH)(0),z=(0,r.yj)(),V=(0,r.tv)(),{entryId:j,expenseId:H}=z.params,Z=(0,a.iH)([d.j.ADMINISTRATOR_ASSOCIATION].includes(null===(W=null===(t=null===(s=null===N||void 0===N?void 0:N.state)||void 0===s?void 0:s.user)||void 0===t?void 0:t.role)||void 0===W?void 0:W.slug)),B=()=>p(this,void 0,void 0,(function*(){U.value=yield i.http.get(`entries/${parseInt(j)}`)})),G=()=>p(this,void 0,void 0,(function*(){const e=yield i.http.get(`entriesdetails?id_entry=${U.value.id}`);F.value=e.rows.reduce(((e,s)=>e+Number(s.value)),0).toFixed(2)})),M=()=>p(this,void 0,void 0,(function*(){const e=yield i.http.get(`expensesdetails?id_expense=${H}`);L.value=e.rows.reduce(((e,s)=>e+Number(s.value)),0).toFixed(2)})),Q=()=>{if(0!==Number.parseFloat(F.value)&&0!==Number.parseFloat(L.value)||Z.value){if("ACTIVE"===U.value.state){let e=`Va a <strong>cerrar</strong> el mes de <strong>${l.e7[U.value.month-1]}</strong> este proceso es irreversible, revise los datos antes de continuar porque ya no podrá modificarlos.`;0!==Number.parseFloat(F.value)&&0!==Number.parseFloat(L.value)||(e+='<br><br><strong class="text-red">VA CERRAR EL MES CON CERO DATOS. ¿Está seguro?</strong>'),(0,u.Confirm)(e,(()=>p(this,void 0,void 0,(function*(){return yield i.http.put(`entries/close/${j}/${H}`),V.push(`/treasury/report/${j}/${H}`)}))),null,"Advertencia","Cerrar mes")}}else c.message.warning("Debe llenar los ingresos y los gastos")},P=()=>{if("ACTIVE"!==U.value.state){const e=`Va a <strong>reabrir</strong> el mes de <strong>${l.e7[U.value.month-1]}</strong>. ¿Está seguro de continuar?`;(0,u.Confirm)(e,(()=>p(this,void 0,void 0,(function*(){return yield i.http.put(`entries/revert/${j}/${H}`),window.location.reload()}))),null,"Advertencia","Reabrir el mes")}};return(0,n.wF)((()=>p(this,void 0,void 0,(function*(){yield B(),yield G(),yield M()})))),(e,s)=>{const t=(0,n.up)("q-btn"),r=(0,n.up)("q-icon");return U.value?((0,n.wg)(),(0,n.iD)("div",v,[(0,n._)("h2",g,[(0,n.Wm)(t,{icon:"arrow_back",round:"",flat:"",onClick:s[0]||(s[0]=s=>e.$router.push("/treasury"))}),(0,n.Uk)(" Ingresos y Gastos de "+(0,o.zw)((0,a.SU)(l.e7)[U.value.month-1])+" "+(0,o.zw)(U.value.year)+" ",1),"CLOSED"===U.value.state?((0,n.wg)(),(0,n.iD)("span",b,"CERRADO")):(0,n.kq)("",!0)]),(0,n._)("div",y,[(0,n._)("div",h,[(0,n.Wm)(t,{flat:"",color:"secondary",padding:"lg","no-caps":"",onClick:s[1]||(s[1]=s=>e.$router.push(`/treasury/week/${e.$route.params.entryId}/${e.$route.params.expenseId}`)),class:"full-width btn-block"},{default:(0,n.w5)((()=>{var s;return[f,(0,n._)("span",k,[_,(0,n.Uk)(),(0,n._)("span",w,(0,o.zw)(F.value)+" "+(0,o.zw)(null===(s=e.$store.state.user)||void 0===s?void 0:s.user.company.money),1)]),(0,n.Wm)(r,{name:"attach_money"})]})),_:1})]),(0,n._)("div",$,[(0,n.Wm)(t,{flat:"",color:"secondary",padding:"lg","no-caps":"",onClick:s[2]||(s[2]=s=>e.$router.push(`/treasury/expense/${e.$route.params.expenseId}`)),class:"full-width btn-block"},{default:(0,n.w5)((()=>{var s;return[C,(0,n._)("span",x,[E,(0,n.Uk)(),(0,n._)("span",I,(0,o.zw)(L.value)+" "+(0,o.zw)(null===(s=e.$store.state.user)||void 0===s?void 0:s.user.company.money),1)]),(0,n.Wm)(r,{name:"payments"})]})),_:1})]),(0,n._)("div",S,[(0,n.Wm)(t,{flat:"",color:"secondary",padding:"lg","no-caps":"",onClick:s[3]||(s[3]=s=>e.$router.push(`/treasury/transactions/${(0,a.SU)(j)}/${(0,a.SU)(H)}`)),class:"full-width btn-block"},{default:(0,n.w5)((()=>[q,D,(0,n.Wm)(r,{name:"point_of_sale"})])),_:1})]),"CLOSED"===U.value.state?((0,n.wg)(),(0,n.iD)("div",O,[(0,n.Wm)(t,{flat:"",color:"secondary",padding:"lg","no-caps":"",onClick:s[4]||(s[4]=s=>e.$router.push(`/treasury/report/${(0,a.SU)(j)}/${(0,a.SU)(H)}`)),class:"full-width btn-block"},{default:(0,n.w5)((()=>[A,T,(0,n.Wm)(r,{name:"today"})])),_:1})])):(0,n.kq)("",!0)]),(0,n._)("div",R,[(0,n.Wm)(t,{label:"Cambiar mes","no-caps":"",icon:"calendar_month",class:"btn-close-month",onClick:s[5]||(s[5]=s=>e.$router.push("/treasury/months"))}),"CLOSED"!==U.value.state?((0,n.wg)(),(0,n.j4)(t,{key:0,label:"CLOSED"===U.value.state?"Ver informe mensual":"Cerrar el mes","no-caps":"",color:"primary",icon:"CLOSED"===U.value.state?"print":"check",class:"btn-close-month",onClick:Q},null,8,["label","icon"])):(0,n.kq)("",!0),"CLOSED"===U.value.state&&Z.value?((0,n.wg)(),(0,n.j4)(t,{key:1,label:"Reabrir el mes","no-caps":"",color:"red",icon:"warning",class:"btn-close-month",onClick:P})):(0,n.kq)("",!0)])])):(0,n.kq)("",!0)}}});var N=t(2165),U=t(4554),F=t(7518),L=t.n(F);const z=W,V=z;L()(W,"components",{QBtn:N.Z,QIcon:U.Z})}}]);