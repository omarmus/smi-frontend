"use strict";(self["webpackChunksmi_frontend"]=self["webpackChunksmi_frontend"]||[]).push([[467],{925:(e,t,n)=>{n.d(t,{e7:()=>a,KS:()=>o,WU:()=>s,Fv:()=>l});const a=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],o=(e,t)=>{const n=new Date(e,t,0).getDate(),a=new Date(e,t-1,1),o=[];for(let s=6-a.getDay(),l=1;s<n;s+=7,l++)o.push({day:s+1,label:`SÃ¡bado ${s+1}`,week:l,total:0});return o},s=e=>{if(!e)return null;const t=new Date(e);return[t.getUTCDate(),t.getUTCMonth()+1,t.getUTCFullYear()].join("/")},l=e=>e?[e.split("/")[2],e.split("/")[1],e.split("/")[0]].join("-"):null},4467:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var a=n(3673),o=n(2323),s=n(1959),l=n(9582),r=n(2993),i=n(925),u=n(9236),c=function(e,t,n,a){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function l(e){try{i(a.next(e))}catch(t){s(t)}}function r(e){try{i(a["throw"](e))}catch(t){s(t)}}function i(e){e.done?n(e.value):o(e.value).then(l,r)}i((a=a.apply(e,t||[])).next())}))};const d={key:0,class:"container"},v={class:"treasury-title"},p={key:0,class:"text-warning"},y={class:"subtitle"},w={class:"row treasury-row"},h={class:"btn-block-detail"},m={class:"text-right q-pt-xs q-gutter-xs"},f=(0,a.aZ)({setup(e){var t,n;const f=(0,u.useStore)(),g=null===(n=null===(t=f.state.user)||void 0===t?void 0:t.user)||void 0===n?void 0:n.company.id,k=(0,s.iH)(),b=(0,s.iH)(),D=(0,s.iH)([]),$=(new Date).getDate(),_=(new Date).getMonth()+1,C=(0,s.iH)(0),x=(0,l.yj)(),{entryId:S}=x.params,q=e=>"CLOSED"===k.value.state||k.value.month!==_?"":e.day>=$-7&&e.day<$?"active":"pending",E=e=>"CLOSED"!==k.value.state&&k.value.month===_&&e.day>=$,z=()=>c(this,void 0,void 0,(function*(){k.value=yield r.http.get(`entries/${parseInt(S)}`),D.value=(0,i.KS)(k.value.year,k.value.month);const e=yield r.http.get(`entriesdetails?id_entry=${k.value.id}`),t={1:0,2:0,3:0,4:0,5:0};e.rows.forEach((e=>{t[e.week]+=parseFloat(e.value)})),C.value=0,D.value.forEach((e=>{e.total=t[e.week],C.value+=e.total}))})),F=()=>c(this,void 0,void 0,(function*(){const e=yield r.http.get(`expenses?year=${k.value.year}&month=${k.value.month}&id_company=${g}`);e.count&&(b.value=e.rows[0])}));return(0,a.wF)((()=>c(this,void 0,void 0,(function*(){yield z(),yield F()})))),(e,t)=>{const n=(0,a.up)("q-btn"),l=(0,a.up)("q-icon");return k.value?((0,a.wg)(),(0,a.iD)("div",d,[(0,a._)("h2",v,[(0,a.Wm)(n,{icon:"arrow_back",round:"",flat:"",onClick:t[0]||(t[0]=t=>e.$router.push(`/treasury/entryexpense/${e.$route.params.entryId}/${b.value.id}`))}),(0,a.Uk)(" Ingresos "+(0,o.zw)((0,s.SU)(i.e7)[k.value.month-1])+" - Diezmos y ofrendas ",1),"CLOSED"===k.value.state?((0,a.wg)(),(0,a.iD)("span",p,"CERRADO")):(0,a.kq)("",!0),(0,a._)("span",y,"Total: "+(0,o.zw)(C.value.toFixed(2))+" Bs.",1)]),(0,a._)("div",w,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(D.value,(t=>((0,a.wg)(),(0,a.iD)("div",{class:"col-xs-6 col-sm-3 q-pa-sm card-button",key:t.week},[(0,a.Wm)(n,{flat:"",color:"secondary",padding:"lg","no-caps":"",onClick:n=>e.$router.push(`/treasury/entry/${e.$route.params.entryId}/${t.week}`),class:(0,o.C_)(["full-width btn-block",q(t)]),disable:E(t)},{default:(0,a.w5)((()=>[(0,a._)("strong",null,(0,o.zw)(t.label),1),(0,a._)("span",h,(0,o.zw)(t.total)+" Bs.",1),(0,a.Wm)(l,{name:"calendar_month"})])),_:2},1032,["onClick","class","disable"])])))),128))]),(0,a._)("div",m,[b.value?((0,a.wg)(),(0,a.j4)(n,{key:0,label:"Ver gastos del mes","no-caps":"",icon:"money_off",padding:"10px 20px",class:"btn-close-month",onClick:t[1]||(t[1]=t=>e.$router.push(`/treasury/expense/${b.value.id}`))})):(0,a.kq)("",!0)])])):(0,a.kq)("",!0)}}});var g=n(8240),k=n(4554),b=n(7518),D=n.n(b);const $=f,_=$;D()(f,"components",{QBtn:g.Z,QIcon:k.Z})}}]);